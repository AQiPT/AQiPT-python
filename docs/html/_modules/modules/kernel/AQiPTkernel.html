


<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>modules.kernel.AQiPTkernel &mdash; AQiPT: Atomic Quantum information Processing Toolbox  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #34495e" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/logo_icon.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../prerequisites.html">Pre-requisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../versions.html">Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../structure.html">Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks.html">Notebooks</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #34495e" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">AQiPT: Atomic Quantum information Processing Toolbox</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">modules.kernel.AQiPTkernel</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for modules.kernel.AQiPTkernel</h1><div class="highlight"><pre>
<span></span><span class="c1">#Atomic Quantum information Processing Tool (AQIPT - /ɪˈkwɪpt/) - DAQ module</span>

<span class="c1"># Author(s): Manuel Morgado. Universite de Strasbourg. Laboratory of Exotic Quantum Matter - CESQ</span>
<span class="c1">#                            Universitaet Stuttgart. 5. Physikalisches Institut - QRydDemo</span>
<span class="c1"># Contributor(s): Angel Alvarez. Universidad Simon Bolivar. Quantum Information and Communication Group.</span>
<span class="c1"># Created: 2021-04-08</span>
<span class="c1"># Last update: 2024-12-14</span>


<span class="c1">#libs</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>

<span class="c1"># from functools import reduce</span>
<span class="c1"># import itertools</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="c1"># from typing import Iterator, List</span>
<span class="kn">import</span> <span class="nn">copy</span>

<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">display</span>

<span class="c1"># from numba import jit</span>
<span class="c1"># import numba</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">dataclasses</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">AQiPT</span> <span class="kn">import</span> <span class="n">AQiPTcore</span> <span class="k">as</span> <span class="n">aqipt</span>
<span class="kn">from</span> <span class="nn">AQiPT.modules.directory</span> <span class="kn">import</span> <span class="n">AQiPTdirectory</span> <span class="k">as</span> <span class="n">dirPath</span>

<span class="kn">import</span> <span class="nn">arc</span>
<span class="kn">from</span> <span class="nn">scipy.constants</span> <span class="kn">import</span> <span class="n">physical_constants</span>
<span class="kn">from</span> <span class="nn">scipy.constants</span> <span class="kn">import</span> <span class="n">e</span> <span class="k">as</span> <span class="n">C_e</span>
<span class="kn">import</span> <span class="nn">qutip</span> <span class="k">as</span> <span class="nn">qt</span>

<span class="kn">import</span> <span class="nn">random</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">directory</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">directory</span><span class="p">;</span>

<span class="c1">###################################################################################################</span>
<span class="c1">#######################                 Backend Kernel                #############################</span>
<span class="c1">###################################################################################################</span>

<span class="c1">#####################################################################################################</span>
<span class="c1">############################          SPECIFICATIONS SECTION             ############################</span>
<span class="c1">#####################################################################################################</span>

<span class="c1">#####################################################################################################</span>
<span class="c1">#atomSpecs AQiPT (data)class</span>
<span class="c1">#####################################################################################################</span>

<span class="k">def</span> <span class="nf">_getFullStates</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">I</span><span class="p">):</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">_states_is_dic</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">is_dict_of_dicts</span><span class="p">(</span><span class="n">states</span><span class="p">);</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">_states_is_dic</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span>

    <span class="k">if</span> <span class="n">_states_is_dic</span><span class="o">!=</span><span class="kc">True</span><span class="p">:</span>

        <span class="n">_full_states_dic</span><span class="o">=</span><span class="p">{};</span><span class="n">_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="n">_state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
            
            <span class="k">for</span> <span class="n">F</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">_state</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">I</span><span class="p">)),</span><span class="nb">int</span><span class="p">(</span><span class="n">_state</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)):</span>
                
                <span class="k">for</span> <span class="n">mF</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="o">-</span><span class="n">F</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">F</span><span class="o">+</span><span class="mi">1</span><span class="p">)):</span>
                    
                    <span class="n">_full_states_dic</span><span class="p">[</span><span class="n">_idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">_state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">_state</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">_state</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">_state</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">F</span><span class="p">,</span> <span class="n">mF</span><span class="p">];</span>
                    <span class="n">_idx</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">_state</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">for</span> <span class="n">_state</span> <span class="ow">in</span> <span class="n">states</span><span class="o">.</span><span class="n">values</span><span class="p">()];</span>

        <span class="n">_full_states_dic</span><span class="o">=</span><span class="p">{};</span><span class="n">_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="n">_state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
            
            <span class="k">for</span> <span class="n">F</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">_state</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">I</span><span class="p">)),</span><span class="nb">int</span><span class="p">(</span><span class="n">_state</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)):</span>
                
                <span class="k">for</span> <span class="n">mF</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="o">-</span><span class="n">F</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">F</span><span class="o">+</span><span class="mi">1</span><span class="p">)):</span>
                    
                    <span class="n">_full_states_dic</span><span class="p">[</span><span class="n">_idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">_state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">_state</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">_state</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">_state</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">F</span><span class="p">,</span> <span class="n">mF</span><span class="p">];</span>
                    <span class="n">_idx</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>

    <span class="k">return</span> <span class="n">_full_states_dic</span>

<span class="k">def</span> <span class="nf">_getStates</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">I</span><span class="p">):</span>

    <span class="n">states</span> <span class="o">=</span> <span class="n">_lst2dic</span><span class="p">(</span><span class="n">states</span><span class="p">);</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">_states_is_dic</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">is_dict_of_dicts</span><span class="p">(</span><span class="n">states</span><span class="p">);</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">_states_is_dic</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span>

    <span class="k">if</span> <span class="n">_states_is_dic</span><span class="o">!=</span><span class="kc">True</span><span class="p">:</span>

        <span class="n">_states_dic</span><span class="o">=</span><span class="p">{};</span><span class="n">_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="n">_state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
            
            <span class="n">_states_dic</span><span class="p">[</span><span class="n">_idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">_state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">_state</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">_state</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">_state</span><span class="p">[</span><span class="mi">3</span><span class="p">]];</span>
            <span class="n">_idx</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">else</span><span class="p">:</span>

        <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">_state</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="k">for</span> <span class="n">_state</span> <span class="ow">in</span> <span class="n">states</span><span class="o">.</span><span class="n">values</span><span class="p">()];</span>

        <span class="n">_states_dic</span><span class="o">=</span><span class="p">{};</span><span class="n">_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="n">_state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
            
            <span class="n">_states_dic</span><span class="p">[</span><span class="n">_idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">_state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">_state</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">_state</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">_state</span><span class="p">[</span><span class="mi">3</span><span class="p">]];</span>
            <span class="n">_idx</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>

    <span class="k">return</span> <span class="n">_states_dic</span>

<span class="k">def</span> <span class="nf">convert_to_float</span><span class="p">(</span><span class="n">frac_str</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">frac_str</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">num</span><span class="p">,</span> <span class="n">denom</span> <span class="o">=</span> <span class="n">frac_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">leading</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">);</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">denom</span><span class="p">)</span>        
        <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">leading</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sign_mult</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sign_mult</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">leading</span><span class="p">)</span> <span class="o">+</span> <span class="n">sign_mult</span> <span class="o">*</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">denom</span><span class="p">));</span>

<span class="k">def</span> <span class="nf">orb2Int</span><span class="p">(</span><span class="n">orb</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">orb</span> <span class="o">==</span><span class="s1">&#39;S&#39;</span> 
            <span class="k">else</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">orb</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span> 
            <span class="k">else</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">orb</span> <span class="o">==</span> <span class="s1">&#39;D&#39;</span> 
            <span class="k">else</span> <span class="mi">3</span> <span class="k">if</span> <span class="n">orb</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span> 
            <span class="k">else</span> <span class="kc">None</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">lst2dic</span><span class="p">(</span><span class="n">ket</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ket</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
        
        <span class="n">ket_lst</span><span class="o">=</span><span class="p">{};</span> <span class="n">nr_state</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        
        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">ket</span><span class="p">:</span>

            <span class="n">l_val</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">state</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">isupper</span><span class="p">()]);</span>
            <span class="n">n_val</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="n">l_val</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
            <span class="n">j_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">state</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span><span class="n">state</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)];</span>
            <span class="n">s_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">state</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">state</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)];</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">f_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">state</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span><span class="n">state</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)];</span>
                <span class="n">mf_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">state</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="p">:</span><span class="n">state</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)];</span>
                <span class="n">ket_lst</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">nr_state</span><span class="p">)]</span><span class="o">=</span><span class="p">({</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span> <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="p">),</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">f_val</span><span class="p">),</span> <span class="s1">&#39;mf&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">mf_val</span><span class="p">)});</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">ket_lst</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">nr_state</span><span class="p">)]</span><span class="o">=</span><span class="p">({</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span> <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="p">),</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="p">)});</span>
                <span class="n">nr_state</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">ket_lst</span>

    <span class="k">else</span><span class="p">:</span>
        
        <span class="n">l_val</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">ket</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">isupper</span><span class="p">()]);</span>
        <span class="n">n_val</span> <span class="o">=</span> <span class="n">ket</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="n">l_val</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
        <span class="n">j_val</span> <span class="o">=</span> <span class="n">ket</span><span class="p">[</span><span class="n">ket</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span><span class="n">ket</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)];</span>
        <span class="n">s_val</span> <span class="o">=</span> <span class="n">ket</span><span class="p">[</span><span class="n">ket</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">ket</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)];</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">f_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">state</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span><span class="n">state</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)];</span>
            <span class="n">mf_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">state</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="p">:</span><span class="n">state</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)];</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span> <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="p">),</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="p">),</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">f_val</span><span class="p">),</span> <span class="s1">&#39;mf&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">mf_val</span><span class="p">)}</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span> <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="p">),</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="p">)}</span>
    
<span class="k">def</span> <span class="nf">atomicData_fromFile</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;pyarrow&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Load atomic data from file (format: .parquet)</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        INPUTS:</span>
<span class="sd">        -------</span>
<span class="sd">        </span>
<span class="sd">            fname : (string) file name</span>
<span class="sd">            engine : (string) readout engine of the file format</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        OUTPUTS:</span>
<span class="sd">        --------</span>
<span class="sd">        </span>
<span class="sd">            atomicData (dataclass)</span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">recovered_DF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">fname</span><span class="o">+</span><span class="s1">&#39;.parquet&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="n">engine</span><span class="p">);</span>
    <span class="n">lenght_DF</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">recovered_DF</span><span class="p">);</span>
    
    <span class="n">_clabelLst</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;cell_labels&#39;</span><span class="p">]</span>
    <span class="n">_cellLst</span><span class="o">=</span><span class="p">[];</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenght_DF</span><span class="p">):</span>
        <span class="n">_recovered2dict</span> <span class="o">=</span> <span class="n">recovered_DF</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="n">_cellLst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">datacell</span><span class="p">(</span><span class="n">_recovered2dict</span><span class="p">[</span><span class="s1">&#39;Energy&#39;</span><span class="p">],</span><span class="n">_recovered2dict</span><span class="p">[</span><span class="s1">&#39;Transition_freq&#39;</span><span class="p">],</span><span class="n">_recovered2dict</span><span class="p">[</span><span class="s1">&#39;Wavelength&#39;</span><span class="p">],</span>
                                  <span class="n">_recovered2dict</span><span class="p">[</span><span class="s1">&#39;Rabi_freq&#39;</span><span class="p">],</span><span class="n">_recovered2dict</span><span class="p">[</span><span class="s1">&#39;Dip_Mat_element&#39;</span><span class="p">],</span><span class="n">_recovered2dict</span><span class="p">[</span><span class="s1">&#39;Lifetime&#39;</span><span class="p">],</span>
                                  <span class="n">_recovered2dict</span><span class="p">[</span><span class="s1">&#39;Rydberg&#39;</span><span class="p">],</span><span class="n">_recovered2dict</span><span class="p">[</span><span class="s1">&#39;BBR&#39;</span><span class="p">],</span><span class="n">_recovered2dict</span><span class="p">[</span><span class="s1">&#39;C3&#39;</span><span class="p">],</span>
                                  <span class="n">_recovered2dict</span><span class="p">[</span><span class="s1">&#39;C6&#39;</span><span class="p">],</span><span class="n">_recovered2dict</span><span class="p">[</span><span class="s1">&#39;Rbl&#39;</span><span class="p">],</span><span class="n">_recovered2dict</span><span class="p">[</span><span class="s1">&#39;LeRoy_radius&#39;</span><span class="p">],</span>
                                  <span class="n">_recovered2dict</span><span class="p">[</span><span class="s1">&#39;Polarizability&#39;</span><span class="p">],</span><span class="n">_recovered2dict</span><span class="p">[</span><span class="s1">&#39;Stark_Map&#39;</span><span class="p">])</span> <span class="p">);</span>
    <span class="k">return</span> <span class="n">atomicData</span><span class="p">(</span><span class="n">_clabelLst</span><span class="p">,</span> <span class="n">_cellLst</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">metadata_fromFile</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;pyarrow&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Load metadata from file (format: .parquet)</span>
<span class="sd">        </span>
<span class="sd">        INPUTS:</span>
<span class="sd">        -------</span>
<span class="sd">        </span>
<span class="sd">            fname : (string) file name</span>
<span class="sd">            engine : (string) readout engine of the file format</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        OUTPUTS:</span>
<span class="sd">        --------</span>
<span class="sd">        </span>
<span class="sd">            metadata (dict)</span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">recovered_DF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;metadata_&#39;</span><span class="o">+</span><span class="n">fname</span><span class="o">+</span><span class="s1">&#39;.parquet&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="n">engine</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">recovered_DF</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">extract_SMapData</span><span class="p">(</span><span class="n">starkMap_obj</span><span class="p">):</span>
    
    <span class="n">_buflst1</span><span class="o">=</span><span class="p">[];</span> <span class="n">_buflst2</span><span class="o">=</span><span class="p">[];</span> <span class="n">_buflst3</span><span class="o">=</span><span class="p">[];</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starkMap_obj</span><span class="o">.</span><span class="n">y</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">starkMap_obj</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)])):</span>
            <span class="n">_buflst1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">starkMap_obj</span><span class="o">.</span><span class="n">eFieldList</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)]);</span>
            <span class="n">_buflst2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">starkMap_obj</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)][</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="p">)]);</span>
            <span class="n">_buflst3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">starkMap_obj</span><span class="o">.</span><span class="n">highlight</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)][</span><span class="nb">int</span><span class="p">(</span><span class="n">j</span><span class="p">)]);</span>
            
    <span class="n">neFieldList</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">_buflst1</span><span class="p">);</span>
    <span class="n">ny</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">_buflst2</span><span class="p">);</span>
    <span class="n">nyState</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">_buflst3</span><span class="p">);</span>

    <span class="n">sortOrder</span> <span class="o">=</span> <span class="n">nyState</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;heapsort&#39;</span><span class="p">);</span>


    <span class="k">return</span> <span class="n">neFieldList</span><span class="p">[</span><span class="n">sortOrder</span><span class="p">],</span> <span class="n">ny</span><span class="p">[</span><span class="n">sortOrder</span><span class="p">],</span> <span class="n">nyState</span><span class="p">[</span><span class="n">sortOrder</span><span class="p">];</span>

<span class="k">def</span> <span class="nf">extract_BBRData</span><span class="p">(</span><span class="n">BBR_obj</span><span class="p">):</span>
<span class="c1">#     return {&#39;n_values&#39; : BBR_obj[&#39;valsn&#39;], &#39;NoBBR_values&#39; : BBR_obj[&#39;valsNoBBR&#39;], &#39;BBR_values&#39; : BBR_obj[&#39;valsBBR&#39;]}</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">BBR_obj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">BBR_obj</span> <span class="k">if</span> <span class="n">i</span><span class="o">!=</span><span class="s1">&#39;figure&#39;</span><span class="p">}</span>
    
<div class="viewcode-block" id="atomSpecs">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomSpecs">[docs]</a>
<span class="k">class</span> <span class="nc">atomSpecs</span><span class="p">:</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Special class of AQiPT that pretty much works as a container of Python inmmutable dataclass </span>
<span class="sd">        i.e., ```atomicData()``` built from more specific mutable dataclass ```datacell()``` that contains </span>
<span class="sd">        specific information of the atoms, as well as properties obtained from ab-initio calculations and </span>
<span class="sd">        data measured by the atomic physics community and wrapped within other Python packages.</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">        </span>
<span class="sd">            atom :</span>
<span class="sd">            _atomName :</span>
<span class="sd">            states :</span>
<span class="sd">            _metadata :</span>
<span class="sd">            atomicdata :</span>
<span class="sd">            __atomicdata2save :</span>
<span class="sd">            _eParams :</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            getTransitionFrequency_fromARC :</span>
<span class="sd">            getTransitionWavelength_fromARC :</span>
<span class="sd">            getRabifreq_fromARC</span>
<span class="sd">            getSMap_fromARC</span>
<span class="sd">            getLifetime_fromARC</span>
<span class="sd">            getPolarizability_fromARC :           </span>
<span class="sd">            getLeRoyRadius_fromARC :</span>
<span class="sd">            getC6_fromARC :</span>
<span class="sd">            getRb_fromARC :</span>
<span class="sd">            getBBR_fromARC :</span>
<span class="sd">            </span>
<span class="sd">            set_atomicData :</span>
<span class="sd">            save :</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extraParams</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;ARC&#39;</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">atom</span><span class="p">;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">_atomName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">elementName</span><span class="p">;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="n">states</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">partialstate</span> <span class="o">=</span> <span class="n">_getStates</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">I</span><span class="o">=</span><span class="mf">1.5</span><span class="p">);</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fullstates</span> <span class="o">=</span> <span class="n">_getFullStates</span><span class="p">(</span><span class="n">_lst2dic</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">I</span><span class="p">);</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span> <span class="o">=</span> <span class="n">extraParams</span><span class="p">;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">_atomicdata2save</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">source</span><span class="p">;</span>
        
        <span class="c1">#given nothing - requires set_atomicData() for atomicData AQiPT-dataclass</span>
        <span class="k">if</span> <span class="n">specs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">metadata</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atomicdata</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span> <span class="c1">#set_atomicData()</span>
        
        <span class="c1">#given the (specs,metadata) - requires an atomicData AQiPT-dataclass</span>
        <span class="k">elif</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">is_dataclass</span><span class="p">(</span><span class="n">specs</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atomicdata</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        
        <span class="c1">#given (specs, metadata) files requires atomicData_fromFile() and metadata_fromFile() to set atomicData AQiPT-dataclass</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">specs</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">metadata_fromFile</span><span class="p">(</span><span class="n">metadata</span><span class="p">);</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atomicdata</span> <span class="o">=</span> <span class="n">atomicData_fromFile</span><span class="p">(</span><span class="n">specs</span><span class="p">);</span>
    
    
    <span class="c1">###############################</span>
    <span class="c1">#### METHODS FOR DATACELLS ####</span>
    <span class="c1">###############################</span>
    
<div class="viewcode-block" id="atomSpecs.getTransitionFrequency_fromARC">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomSpecs.getTransitionFrequency_fromARC">[docs]</a>
    <span class="k">def</span> <span class="nf">getTransitionFrequency_fromARC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">istate</span><span class="p">,</span> <span class="n">jstate</span><span class="p">):</span>
        <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">getTransitionFrequency</span><span class="p">(</span><span class="n">istate</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">],</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">],</span>
                                                 <span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">],</span> <span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">])</span><span class="o">*</span><span class="mf">1e-12</span></div>


<div class="viewcode-block" id="atomSpecs.getTransitionWavelength_fromARC">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomSpecs.getTransitionWavelength_fromARC">[docs]</a>
    <span class="k">def</span> <span class="nf">getTransitionWavelength_fromARC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">istate</span><span class="p">,</span> <span class="n">jstate</span><span class="p">):</span>
        <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">getTransitionWavelength</span><span class="p">(</span><span class="n">istate</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">],</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">],</span>
                                                  <span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">],</span> <span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">])</span><span class="o">*</span><span class="mf">1e9</span></div>


<div class="viewcode-block" id="atomSpecs.getRabifreq_fromARC">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomSpecs.getRabifreq_fromARC">[docs]</a>
    <span class="k">def</span> <span class="nf">getRabifreq_fromARC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">istate</span><span class="p">,</span> <span class="n">jstate</span><span class="p">,</span> <span class="n">polarization</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">waist</span><span class="p">):</span>
        <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">getRabiFrequency</span><span class="p">(</span><span class="n">istate</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">],</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">],</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">],</span> <span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">],</span> <span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">],</span> <span class="n">polarization</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">waist</span><span class="p">)</span><span class="o">*</span><span class="mf">1e-6</span></div>


<div class="viewcode-block" id="atomSpecs.getSMap_fromARC">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomSpecs.getSMap_fromARC">[docs]</a>
    <span class="k">def</span> <span class="nf">getSMap_fromARC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">istate</span><span class="p">,</span> <span class="n">nrange</span><span class="p">,</span> <span class="n">lmax</span><span class="p">,</span> <span class="n">Bz</span><span class="p">,</span> <span class="n">Erange</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">progressBar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">HighlightState</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">HighlightColour</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">):</span>

        <span class="c1">#create Stark map object</span>
        <span class="n">sMap</span> <span class="o">=</span> <span class="n">arc</span><span class="o">.</span><span class="n">StarkMap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">);</span>

        <span class="n">sMap</span><span class="o">.</span><span class="n">defineBasis</span><span class="p">(</span><span class="n">istate</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">],</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">],</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">],</span> <span class="n">nrange</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nrange</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lmax</span><span class="p">,</span> <span class="n">Bz</span><span class="p">,</span> <span class="n">progressOutput</span><span class="o">=</span><span class="n">progressBar</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span> <span class="c1">#initialise Basis States for Solver : progressOutput=True gives verbose output</span>

        <span class="c1">#generate Stark map</span>
        <span class="n">sMap</span><span class="o">.</span><span class="n">diagonalise</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">Erange</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Erange</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">N</span><span class="p">),</span> <span class="n">progressOutput</span><span class="o">=</span><span class="n">progressBar</span><span class="p">);</span>

        <span class="c1">#show Stark map</span>
        <span class="n">sMap</span><span class="o">.</span><span class="n">plotLevelDiagram</span><span class="p">(</span><span class="n">progressOutput</span><span class="o">=</span><span class="n">progressBar</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span> <span class="n">highlightState</span><span class="o">=</span><span class="n">HighlightState</span><span class="p">,</span> <span class="n">highlightColour</span><span class="o">=</span><span class="n">HighlightColour</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">sMap</span></div>


<div class="viewcode-block" id="atomSpecs.getLifetime_fromARC">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomSpecs.getLifetime_fromARC">[docs]</a>
    <span class="k">def</span> <span class="nf">getLifetime_fromARC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">istate</span><span class="p">):</span>
        <span class="k">return</span>  <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">getStateLifetime</span><span class="p">(</span><span class="n">istate</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">],</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">])</span></div>


<div class="viewcode-block" id="atomSpecs.isRydberg">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomSpecs.isRydberg">[docs]</a>
    <span class="k">def</span> <span class="nf">isRydberg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">istate</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">20</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="atomSpecs.getBBR_fromARC">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomSpecs.getBBR_fromARC">[docs]</a>
    <span class="k">def</span> <span class="nf">getBBR_fromARC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nMin</span><span class="p">,</span> <span class="n">nMax</span><span class="p">,</span> <span class="n">lj1</span><span class="p">,</span> <span class="n">lj2</span><span class="p">,</span> <span class="n">minTemp</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">maxTemp</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>

        <span class="n">vals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;valsn&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;valsNoBBR&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;valsBBR&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;figure&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nMin</span><span class="p">,</span><span class="n">nMax</span><span class="p">):</span>

            <span class="n">noBBR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">getTransitionRate</span><span class="p">(</span><span class="n">nMax</span><span class="p">,</span> <span class="n">lj1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lj1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n</span><span class="p">,</span> <span class="n">lj2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lj2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">temperature</span><span class="o">=</span><span class="n">minTemp</span><span class="p">)</span>\
                    <span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">getTransitionRate</span><span class="p">(</span><span class="n">nMax</span><span class="p">,</span> <span class="n">lj1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lj1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n</span><span class="p">,</span> <span class="n">lj2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lj2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">lj2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">temperature</span><span class="o">=</span><span class="n">minTemp</span><span class="p">);</span>
            <span class="n">withBBR</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">getTransitionRate</span><span class="p">(</span><span class="n">nMax</span><span class="p">,</span> <span class="n">lj1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lj1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n</span><span class="p">,</span> <span class="n">lj2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lj2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">temperature</span><span class="o">=</span><span class="n">maxTemp</span><span class="p">)</span>\
                    <span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">getTransitionRate</span><span class="p">(</span><span class="n">nMax</span><span class="p">,</span> <span class="n">lj1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lj1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n</span><span class="p">,</span> <span class="n">lj2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lj2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">lj2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">temperature</span><span class="o">=</span><span class="n">maxTemp</span><span class="p">)</span>
            <span class="n">vals</span><span class="p">[</span><span class="s1">&#39;valsn&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
            <span class="n">vals</span><span class="p">[</span><span class="s1">&#39;valsNoBBR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">noBBR</span><span class="p">);</span>
            <span class="n">vals</span><span class="p">[</span><span class="s1">&#39;valsBBR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">withBBR</span><span class="o">-</span><span class="n">noBBR</span><span class="p">);</span>

        <span class="n">width</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">;</span>

        <span class="n">figBBR</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">vals</span><span class="p">[</span><span class="s1">&#39;figure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">figBBR</span><span class="p">,</span> <span class="n">ax</span><span class="p">];</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="s1">&#39;valsn&#39;</span><span class="p">])</span><span class="o">-</span><span class="n">width</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="s1">&#39;valsNoBBR&#39;</span><span class="p">]),</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Spontaneous decays $n=$</span><span class="si">%.2i</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">nMax</span><span class="p">);</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="s1">&#39;valsn&#39;</span><span class="p">])</span><span class="o">+</span><span class="n">width</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="s1">&#39;valsBBR&#39;</span><span class="p">]),</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Black-body induced transitions $n=$</span><span class="si">%.2i</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">nMax</span><span class="p">);</span>


        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Principal quantum number, $n$&quot;</span><span class="p">);</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Transition rate (s$</span><span class="si">{}</span><span class="s2">^{-1}$)&quot;</span><span class="p">);</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Transition from $\{\ell,m\}$ $S_{1/2}$ to $n$ $P_{1/2,3/2}$&quot;</span><span class="p">);</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">nMax</span><span class="p">,</span><span class="n">l</span><span class="p">));</span>

        <span class="k">return</span> <span class="n">vals</span></div>


<div class="viewcode-block" id="atomSpecs.getC6_fromARC">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomSpecs.getC6_fromARC">[docs]</a>
    <span class="k">def</span> <span class="nf">getC6_fromARC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sMap</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">dn</span><span class="p">,</span> <span class="n">dEmax</span><span class="p">,</span> <span class="n">plotON</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">arc</span><span class="o">.</span><span class="n">PairStateInteractions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">j</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">j</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>

        <span class="n">c6</span><span class="o">=</span><span class="p">[];</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">theta</span><span class="p">:</span>
            <span class="n">C6</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">getC6perturbatively</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">dn</span><span class="p">,</span> <span class="n">dEmax</span><span class="p">)</span>
            <span class="n">c6</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">C6</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">plotON</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;polar&#39;</span><span class="p">);</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_theta_zero_location</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">);</span>
            <span class="n">line</span> <span class="o">=</span> <span class="p">[];</span>

            <span class="c1"># plot results</span>
            <span class="n">lineLegend</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">c6</span><span class="p">,</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;mj=</span><span class="si">%d</span><span class="s2">/2&quot;</span><span class="o">%</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sMap</span><span class="o">.</span><span class="n">s</span><span class="p">))</span> <span class="p">)</span>
            <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lineLegend</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">line</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">c6</span><span class="p">,</span> <span class="n">ax</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">return</span> <span class="n">c6</span></div>


<div class="viewcode-block" id="atomSpecs.getRb_fromARC">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomSpecs.getRb_fromARC">[docs]</a>
    <span class="k">def</span> <span class="nf">getRb_fromARC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">omega_lst</span><span class="p">,</span> <span class="n">c6_lst</span><span class="p">):</span>
        <span class="n">Rb_lst</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">for</span> <span class="n">C6</span> <span class="ow">in</span> <span class="n">c6_lst</span><span class="p">:</span>
            <span class="n">Rb_lst</span><span class="o">.</span><span class="n">append</span><span class="p">([((</span><span class="n">C6</span><span class="o">*</span><span class="mf">1e6</span><span class="o">/</span><span class="n">omega</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">))</span> <span class="k">for</span> <span class="n">omega</span> <span class="ow">in</span> <span class="n">omega_lst</span><span class="p">])</span>
            
        <span class="k">return</span> <span class="n">Rb_lst</span>    </div>


<div class="viewcode-block" id="atomSpecs.getLeRoyRadius_fromARC">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomSpecs.getLeRoyRadius_fromARC">[docs]</a>
    <span class="k">def</span> <span class="nf">getLeRoyRadius_fromARC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sMap</span><span class="p">):</span>
        <span class="n">calc</span> <span class="o">=</span> <span class="n">arc</span><span class="o">.</span><span class="n">PairStateInteractions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">j</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">j</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">calc</span><span class="o">.</span><span class="n">getLeRoyRadius</span><span class="p">()</span></div>


<div class="viewcode-block" id="atomSpecs.getPolarizability_fromARC">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomSpecs.getPolarizability_fromARC">[docs]</a>
    <span class="k">def</span> <span class="nf">getPolarizability_fromARC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sMap</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">):</span>

        <span class="n">polarizabilityList</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">sP</span> <span class="o">=</span> <span class="n">sMap</span><span class="o">.</span><span class="n">getPolarizability</span><span class="p">(</span> <span class="n">minStateContribution</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
    <span class="c1">#     print(&quot;%s\t%.3e\t\t\t\t%.2f-%.2f&quot; % \</span>
    <span class="c1">#         (printStateString(n,0, 0.5), sP, minEfield/100.,maxEfield/100.))</span>
        <span class="n">polarizabilityList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sP</span><span class="p">)</span>

        <span class="n">dP</span> <span class="o">=</span> <span class="n">arc</span><span class="o">.</span><span class="n">DynamicPolarizability</span><span class="p">(</span><span class="n">sMap</span><span class="o">.</span><span class="n">atom</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">l</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">j</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">sMap</span><span class="o">.</span><span class="n">s</span><span class="p">);</span>
        <span class="n">dP</span><span class="o">.</span><span class="n">defineBasis</span><span class="p">(</span><span class="n">sMap</span><span class="o">.</span><span class="n">nMin</span><span class="p">,</span> <span class="n">sMap</span><span class="o">.</span><span class="n">nMax</span><span class="p">);</span>
        <span class="n">dynPol</span> <span class="o">=</span> <span class="n">dP</span><span class="o">.</span><span class="n">getPolarizability</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;SI&#39;</span><span class="p">,</span> <span class="n">accountForStateLifetime</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mj</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">polarizabilityList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dynPol</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">polarizabilityList</span></div>

  
<div class="viewcode-block" id="atomSpecs.set_atomicData">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomSpecs.set_atomicData">[docs]</a>
    <span class="k">def</span> <span class="nf">set_atomicData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;ARC&#39;</span><span class="p">,</span> <span class="n">bfield_ON</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Should go pair by pair of states and generate the datacell() to ultimately create atomicData() dataclass that belongs</span>
<span class="sd">        to the atomSpecs class</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">_labels</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">_cells</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="n">_cells2save</span><span class="o">=</span><span class="p">[];</span>

        <span class="k">if</span> <span class="n">source</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="o">=</span><span class="n">source</span><span class="p">;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="o">==</span><span class="s1">&#39;ARC&#39;</span><span class="p">:</span>
            <span class="c1"># self.fullstates = _getFullStates(states_dict, self.atom.I);</span>

            <span class="k">if</span> <span class="n">bfield_ON</span><span class="p">:</span>
                <span class="n">states_dict</span> <span class="o">=</span> <span class="n">_lst2dic</span><span class="p">([</span><span class="n">_state_v</span> <span class="k">for</span> <span class="n">_state_k</span><span class="p">,</span> <span class="n">_state_v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullstates</span><span class="o">.</span><span class="n">items</span><span class="p">()]);</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">states_dict</span> <span class="o">=</span> <span class="n">_lst2dic</span><span class="p">([</span><span class="n">_state_v</span> <span class="k">for</span> <span class="n">_state_k</span><span class="p">,</span> <span class="n">_state_v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">partialstate</span><span class="o">.</span><span class="n">items</span><span class="p">()]);</span>            

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">states_dict</span><span class="p">)),</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">bfield_ON</span><span class="p">:</span>
                    <span class="n">istate</span> <span class="o">=</span> <span class="n">states_dict</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="c1">#istate as dict like {&#39;n&#39;: &lt;val&gt;, &#39;l&#39;: &lt;val&gt;, &#39;j&#39;: &lt;val&gt;, &#39;s&#39;: &lt;val&gt;}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">istate</span> <span class="o">=</span> <span class="n">states_dict</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>  <span class="c1">#istate as dict like {&#39;n&#39;: &lt;val&gt;, &#39;l&#39;: &lt;val&gt;, &#39;j&#39;: &lt;val&gt;, &#39;s&#39;: &lt;val&gt;, &#39;F&#39;: &lt;val&gt;, &#39;mF&#39;: &lt;val&gt;}</span>

                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">states_dict</span><span class="p">))):</span>

                    <span class="k">if</span> <span class="n">bfield_ON</span><span class="p">:</span>
                        <span class="n">jstate</span> <span class="o">=</span> <span class="n">states_dict</span><span class="p">[</span><span class="n">j</span><span class="p">];</span> <span class="c1">#istate as dict like {&#39;n&#39;: &lt;val&gt;, &#39;l&#39;: &lt;val&gt;, &#39;j&#39;: &lt;val&gt;, &#39;s&#39;: &lt;val&gt;}</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">jstate</span> <span class="o">=</span> <span class="n">states_dict</span><span class="p">[</span><span class="n">j</span><span class="p">];</span> <span class="c1">#jstate as dict like {&#39;n&#39;: &lt;val&gt;, &#39;l&#39;: &lt;val&gt;, &#39;j&#39;: &lt;val&gt;, &#39;s&#39;: &lt;val&gt;, &#39;F&#39;: &lt;val&gt;, &#39;mF&#39;: &lt;val&gt;}</span>

                    <span class="n">_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;X&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;|&#39;</span><span class="p">);</span> <span class="c1">#adding labels for atomicData dataclass</span>
                    
                    
                    <span class="c1">#gettting data from ARC</span>

                    <span class="c1">#transition frequency</span>
                    <span class="n">__TransitionFrequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTransitionFrequency_fromARC</span><span class="p">(</span><span class="n">istate</span><span class="p">,</span> <span class="n">jstate</span><span class="p">);</span>
                    

                    <span class="c1">#transition wavelength</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">__TransitionWavelenght</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTransitionWavelength_fromARC</span><span class="p">(</span><span class="n">istate</span><span class="p">,</span> <span class="n">jstate</span><span class="p">);</span>

                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">__TransitionWavelenght</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>


                    <span class="c1">#rabi frequency</span>
                    <span class="n">__RabiFrequency</span> <span class="o">=</span> <span class="p">[];</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">__RabiFrequency</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRabifreq_fromARC</span><span class="p">(</span><span class="n">istate</span><span class="p">,</span> 
                                                                   <span class="n">jstate</span><span class="p">,</span> 
                                                                   <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4RabiFreq&#39;</span><span class="p">][</span><span class="s1">&#39;polarization&#39;</span><span class="p">],</span> 
                                                                   <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4RabiFreq&#39;</span><span class="p">][</span><span class="s1">&#39;power&#39;</span><span class="p">],</span> 
                                                                   <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4RabiFreq&#39;</span><span class="p">][</span><span class="s1">&#39;waist&#39;</span><span class="p">]);</span>

                    <span class="k">except</span><span class="p">:</span>

                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">__RabiFrequency</span><span class="o">.</span><span class="n">append</span><span class="p">([[</span><span class="bp">self</span><span class="o">.</span><span class="n">getRabifreq_fromARC</span><span class="p">(</span><span class="n">istate</span><span class="p">,</span> 
                                                                              <span class="n">jstate</span><span class="p">,</span> 
                                                                              <span class="nb">int</span><span class="p">(</span><span class="n">laser</span><span class="o">.</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;beams&#39;</span><span class="p">][</span><span class="n">_beam_idx</span><span class="p">][</span><span class="s1">&#39;Polarization&#39;</span><span class="p">]),</span> 
                                                                              <span class="nb">float</span><span class="p">(</span><span class="n">laser</span><span class="o">.</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;beams&#39;</span><span class="p">][</span><span class="n">_beam_idx</span><span class="p">][</span><span class="s1">&#39;Power&#39;</span><span class="p">]),</span> 
                                                                              <span class="nb">float</span><span class="p">(</span><span class="n">laser</span><span class="o">.</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;beams&#39;</span><span class="p">][</span><span class="n">_beam_idx</span><span class="p">][</span><span class="s1">&#39;Waist&#39;</span><span class="p">]))</span>  <span class="k">for</span> <span class="n">_beam_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">laser</span><span class="o">.</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;beams&#39;</span><span class="p">]))</span> <span class="p">]</span> <span class="k">for</span> <span class="n">laser</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4RabiFreq&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="n">__TransitionWavelenght</span><span class="o">-</span><span class="n">laser</span><span class="o">.</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;Wavelength&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">]);</span>
                        
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">__RabiFrequency</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">);</span>


                    <span class="c1">#starkmap</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4SMap&#39;</span><span class="p">]:</span>
                        <span class="n">__StarkMap</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">__StarkMap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSMap_fromARC</span><span class="p">(</span><span class="n">istate</span><span class="p">,</span> 
                                                          <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4SMap&#39;</span><span class="p">][</span><span class="s1">&#39;nrange&#39;</span><span class="p">],</span> 
                                                          <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4SMap&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span> 
                                                          <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4SMap&#39;</span><span class="p">][</span><span class="s1">&#39;bz&#39;</span><span class="p">],</span> 
                                                          <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4SMap&#39;</span><span class="p">][</span><span class="s1">&#39;erange&#39;</span><span class="p">],</span> 
                                                          <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4SMap&#39;</span><span class="p">][</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> 
                                                          <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4SMap&#39;</span><span class="p">][</span><span class="s1">&#39;progressbar&#39;</span><span class="p">],</span> 
                                                          <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4SMap&#39;</span><span class="p">][</span><span class="s1">&#39;unit&#39;</span><span class="p">],</span> 
                                                          <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4SMap&#39;</span><span class="p">][</span><span class="s1">&#39;highlightstate&#39;</span><span class="p">],</span> 
                                                          <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4SMap&#39;</span><span class="p">][</span><span class="s1">&#39;highlightcolour&#39;</span><span class="p">]);</span>


                    <span class="c1">#spontaneous decay</span>
                    <span class="n">__NaturalLifetime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLifetime_fromARC</span><span class="p">(</span><span class="n">istate</span><span class="p">);</span>
                    

                    <span class="c1">#rydberg state</span>
                    <span class="n">__RydbergState</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">isRydberg</span><span class="p">(</span><span class="n">istate</span><span class="p">);</span>
                    

                    <span class="c1">#blackbody radiation</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">__BlackBodyRadiation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getBBR_fromARC</span><span class="p">(</span><span class="n">istate</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4BBR&#39;</span><span class="p">][</span><span class="s1">&#39;dn&#39;</span><span class="p">],</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4BBR&#39;</span><span class="p">][</span><span class="s1">&#39;dn&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4BBR&#39;</span><span class="p">][</span><span class="s1">&#39;lj_vals&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4BBR&#39;</span><span class="p">][</span><span class="s1">&#39;lj_vals&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4BBR&#39;</span><span class="p">][</span><span class="s1">&#39;mintemp&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4BBR&#39;</span><span class="p">][</span><span class="s1">&#39;maxtemp&#39;</span><span class="p">]);</span>
                    
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">__BlackBodyRadiation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
                    

                    <span class="c1">#c6</span>
                    <span class="k">if</span> <span class="n">__RydbergState</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">__C6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getC6_fromARC</span><span class="p">(</span><span class="n">__StarkMap</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4C6&#39;</span><span class="p">][</span><span class="s1">&#39;phi&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4C6&#39;</span><span class="p">][</span><span class="s1">&#39;theta&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4C6&#39;</span><span class="p">][</span><span class="s1">&#39;dn&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4C6&#39;</span><span class="p">][</span><span class="s1">&#39;dEmax&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4C6&#39;</span><span class="p">][</span><span class="s1">&#39;ploton&#39;</span><span class="p">]</span> <span class="p">);</span>

                        <span class="n">__BlockadeRadius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRb_fromARC</span><span class="p">([</span><span class="n">__RabiFrequency</span><span class="p">],</span> <span class="n">__C6</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
                    
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">__C6</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
                        <span class="n">__BlockadeRadius</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
                    
                    <span class="c1">#LeRoyRadius</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eParams</span><span class="p">[</span><span class="s1">&#39;4SMap&#39;</span><span class="p">]:</span>
                        <span class="n">__LeRoyRadius</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">__LeRoyRadius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLeRoyRadius_fromARC</span><span class="p">(</span> <span class="n">__StarkMap</span><span class="p">);</span>
                    
                    <span class="c1">#polarizability</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">__Polarizability</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getPolarizability_fromARC</span><span class="p">(</span><span class="n">__StarkMap</span><span class="p">,</span> <span class="n">__TransitionWavelenght</span><span class="p">);</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">__Polarizability</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
                        
                    <span class="c1">##NotImplemented</span>
                    <span class="c1">#energy</span>
                    <span class="n">__Energy</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
                    <span class="c1">#c3</span>
                    <span class="n">__C3</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
                    <span class="c1">#dipole matrix element</span>
                    <span class="n">__Dip_Mat_element</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
                    
                    <span class="c1">#datacell for python object</span>
                    <span class="n">_cell</span> <span class="o">=</span> <span class="n">datacell</span><span class="p">(</span><span class="n">Energy</span><span class="o">=</span><span class="n">__Energy</span><span class="p">,</span>
                                     <span class="n">Transition_freq</span><span class="o">=</span><span class="n">__TransitionFrequency</span><span class="p">,</span>
                                     <span class="n">Wavelength</span><span class="o">=</span><span class="n">__TransitionWavelenght</span><span class="p">,</span>
                                     <span class="n">Rabi_freq</span><span class="o">=</span><span class="n">__RabiFrequency</span><span class="p">,</span>
                                     <span class="n">Dip_Mat_element</span><span class="o">=</span><span class="n">__Dip_Mat_element</span><span class="p">,</span>
                                     <span class="n">Lifetime</span><span class="o">=</span><span class="n">__NaturalLifetime</span><span class="p">,</span>
                                     <span class="n">Rydberg</span><span class="o">=</span><span class="n">__RydbergState</span><span class="p">,</span>
                                     <span class="n">BBR</span><span class="o">=</span><span class="n">__BlackBodyRadiation</span><span class="p">,</span>
                                     <span class="n">C3</span><span class="o">=</span><span class="n">__C3</span><span class="p">,</span>
                                     <span class="n">C6</span><span class="o">=</span><span class="n">__C6</span><span class="p">,</span>
                                     <span class="n">Rbl</span><span class="o">=</span><span class="n">__BlockadeRadius</span><span class="p">,</span>
                                     <span class="n">LeRoy_radius</span><span class="o">=</span><span class="n">__LeRoyRadius</span><span class="p">,</span>
                                     <span class="n">Polarizability</span><span class="o">=</span><span class="n">__Polarizability</span><span class="p">,</span>
                                     <span class="n">Stark_Map</span><span class="o">=</span><span class="n">__StarkMap</span><span class="p">,);</span>
                    <span class="n">_cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_cell</span><span class="p">);</span>
                    
                    <span class="c1">#datacell for stored file</span>
                    <span class="c1">#adding exceptions that includes plots</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">_c6COPY</span> <span class="o">=</span> <span class="n">__C6</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">_c6COPY</span> <span class="o">=</span> <span class="n">__C6</span><span class="p">;</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">_BBRCOPY</span> <span class="o">=</span> <span class="n">extract_BBRData</span><span class="p">(</span><span class="n">__BlackBodyRadiation</span><span class="p">);</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">_BBRCOPY</span> <span class="o">=</span> <span class="n">__BlackBodyRadiation</span><span class="p">;</span>
                    <span class="k">try</span><span class="p">:</span>   
                        <span class="n">_cell2save</span> <span class="o">=</span> <span class="n">datacell</span><span class="p">(</span><span class="n">Energy</span><span class="o">=</span><span class="n">__Energy</span><span class="p">,</span>
                                              <span class="n">Transition_freq</span><span class="o">=</span><span class="n">__TransitionFrequency</span><span class="p">,</span>
                                              <span class="n">Wavelength</span><span class="o">=</span><span class="n">__TransitionWavelenght</span><span class="p">,</span>
                                              <span class="n">Rabi_freq</span><span class="o">=</span><span class="n">__RabiFrequency</span><span class="p">,</span>
                                              <span class="n">Dip_Mat_element</span><span class="o">=</span><span class="n">__Dip_Mat_element</span><span class="p">,</span>
                                              <span class="n">Lifetime</span><span class="o">=</span><span class="n">__NaturalLifetime</span><span class="p">,</span>
                                              <span class="n">Rydberg</span><span class="o">=</span><span class="n">__RydbergState</span><span class="p">,</span>
                                              <span class="n">BBR</span><span class="o">=</span><span class="n">_BBRCOPY</span><span class="p">,</span>
                                              <span class="n">C3</span><span class="o">=</span><span class="n">__C3</span><span class="p">,</span>
                                              <span class="n">C6</span><span class="o">=</span><span class="n">_c6COPY</span><span class="p">,</span>
                                              <span class="n">Rbl</span><span class="o">=</span><span class="n">__BlockadeRadius</span><span class="p">,</span>
                                              <span class="n">LeRoy_radius</span><span class="o">=</span><span class="n">__LeRoyRadius</span><span class="p">,</span>
                                              <span class="n">Polarizability</span><span class="o">=</span><span class="n">__Polarizability</span><span class="p">,</span>
                                              <span class="n">Stark_Map</span><span class="o">=</span><span class="n">extract_SMapData</span><span class="p">(</span><span class="n">__StarkMap</span><span class="p">));</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">_cell2save</span> <span class="o">=</span> <span class="n">datacell</span><span class="p">(</span><span class="n">Energy</span><span class="o">=</span><span class="n">__Energy</span><span class="p">,</span>
                                              <span class="n">Transition_freq</span><span class="o">=</span><span class="n">__TransitionFrequency</span><span class="p">,</span>
                                              <span class="n">Wavelength</span><span class="o">=</span><span class="n">__TransitionWavelenght</span><span class="p">,</span>
                                              <span class="n">Rabi_freq</span><span class="o">=</span><span class="n">__RabiFrequency</span><span class="p">,</span>
                                              <span class="n">Dip_Mat_element</span><span class="o">=</span><span class="n">__Dip_Mat_element</span><span class="p">,</span>
                                              <span class="n">Lifetime</span><span class="o">=</span><span class="n">__NaturalLifetime</span><span class="p">,</span>
                                              <span class="n">Rydberg</span><span class="o">=</span><span class="n">__RydbergState</span><span class="p">,</span>
                                              <span class="n">BBR</span><span class="o">=</span><span class="n">_BBRCOPY</span><span class="p">,</span>
                                              <span class="n">C3</span><span class="o">=</span><span class="n">__C3</span><span class="p">,</span>
                                              <span class="n">C6</span><span class="o">=</span><span class="n">_c6COPY</span><span class="p">,</span>
                                              <span class="n">Rbl</span><span class="o">=</span><span class="n">__BlockadeRadius</span><span class="p">,</span>
                                              <span class="n">LeRoy_radius</span><span class="o">=</span><span class="n">__LeRoyRadius</span><span class="p">,</span>
                                              <span class="n">Polarizability</span><span class="o">=</span><span class="n">__Polarizability</span><span class="p">,</span>
                                              <span class="n">Stark_Map</span><span class="o">=</span><span class="kc">None</span><span class="p">);</span>
                    <span class="n">_cells2save</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_cell2save</span><span class="p">);</span>
                    
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">_cells</span><span class="p">))</span><span class="o">+</span><span class="s2">&quot; cells&quot;</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;cell_labels&#39;</span> <span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">_labels</span><span class="p">)});</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atomicdata</span> <span class="o">=</span> <span class="n">atomicData</span><span class="p">(</span><span class="n">clabel</span><span class="o">=</span><span class="n">_labels</span><span class="p">,</span> <span class="n">cells</span><span class="o">=</span><span class="n">_cells</span> <span class="p">);</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_atomicdata2save</span> <span class="o">=</span> <span class="n">atomicData</span><span class="p">(</span><span class="n">clabel</span><span class="o">=</span><span class="n">_labels</span><span class="p">,</span> <span class="n">cells</span><span class="o">=</span><span class="n">_cells2save</span> <span class="p">);</span></div>

    
<div class="viewcode-block" id="atomSpecs.update">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomSpecs.update">[docs]</a>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">recompilation</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    
        <span class="k">if</span> <span class="n">variable</span><span class="o">==</span><span class="s1">&#39;power&#39;</span><span class="p">:</span>
            <span class="k">pass</span> </div>

    
<div class="viewcode-block" id="atomSpecs.save">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomSpecs.save">[docs]</a>
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="n">cformat</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Store the data of the atomic specifications and metadata in .parquet format compressed files.</span>
<span class="sd">            </span>
<span class="sd">            INPUTS:</span>
<span class="sd">            -------</span>
<span class="sd">            </span>
<span class="sd">                fname :</span>
<span class="sd">                cformat :</span>
<span class="sd">                schema :</span>
<span class="sd">            </span>
<span class="sd">            OUTPUTS:</span>
<span class="sd">            --------</span>
<span class="sd">            </span>
<span class="sd">                &lt;atomicspecification&gt;.parquet file</span>
<span class="sd">                &lt;metadata&gt;.parquet file</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">fullDataFrame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">cell</span><span class="p">])</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atomicdata2save</span><span class="o">.</span><span class="n">cells</span><span class="p">]);</span>
        
        <span class="k">if</span> <span class="n">schema</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
            <span class="n">_metadaDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
            <span class="n">_metadaDF</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s1">&#39;metadata_&#39;</span><span class="o">+</span><span class="n">fname</span><span class="o">+</span><span class="s1">&#39;.parquet&#39;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="n">cformat</span><span class="p">);</span>
            <span class="n">fullDataFrame</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">fname</span><span class="o">+</span><span class="s1">&#39;.parquet&#39;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="n">cformat</span><span class="p">);</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Atomic specifications stored!&#39;</span><span class="p">)</span>
        
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_metadaDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
            <span class="n">_metadaDF</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s1">&#39;metadata_&#39;</span><span class="o">+</span><span class="n">fname</span><span class="o">+</span><span class="s1">&#39;.parquet&#39;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="n">cformat</span><span class="p">);</span>
            <span class="n">paTable</span> <span class="o">=</span> <span class="n">pa</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">fullDataFrame</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">pa</span><span class="o">.</span><span class="n">Schema</span><span class="o">.</span><span class="n">from_pandas</span><span class="p">(</span><span class="n">fullDataFrame</span><span class="p">),</span> <span class="n">nthreads</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">());</span>
            <span class="n">pq</span><span class="o">.</span><span class="n">write_table</span><span class="p">(</span><span class="n">paTable</span><span class="p">,</span> <span class="n">fname</span><span class="o">+</span><span class="s1">&#39;.parquet&#39;</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="n">cformat</span><span class="p">);</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Atomic specifications stored!&#39;</span><span class="p">)</span>  </div>
</div>

         
<div class="viewcode-block" id="atomicData">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.atomicData">[docs]</a>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">atomicData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Special dataclass of AQiPT that store the data of many (i,j) tuple of states of single and multiple</span>
<span class="sd">        atoms using datacells dataclass.</span>
<span class="sd">        </span>
<span class="sd">        ATTRIBUTES/FIELDS:</span>
<span class="sd">        ------------------</span>

<span class="sd">            clabel (list): labels of the cells in atomicData dataclass, usual labels &#39;|iXj|&#39; for the i-th and j-th</span>
<span class="sd">                           states, correspondent to the i,j in {0, 1, 2, 3,...} for the elements of the state list</span>
<span class="sd">            </span>
<span class="sd">            cells  (list): list of datacells containing all physics information related to the state tuple (i,j)</span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1">#fields</span>
    <span class="n">clabel</span> <span class="p">:</span> <span class="nb">list</span><span class="p">;</span>
    <span class="n">cells</span> <span class="p">:</span> <span class="nb">list</span><span class="p">;</span></div>

    
<div class="viewcode-block" id="datacell">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.datacell">[docs]</a>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">datacell</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Special dataclass of AQiPT that store the data of one (i,j) tuple of states of single or multiple</span>
<span class="sd">        atoms.</span>
<span class="sd">        </span>
<span class="sd">        ATTRIBUTES/FIELDS:</span>
<span class="sd">        ------------------</span>
<span class="sd">        </span>
<span class="sd">            Energy :</span>
<span class="sd">            Transition_freq :</span>
<span class="sd">            Wavelength :</span>
<span class="sd">            Rabi_freq :</span>
<span class="sd">            Dip_Mat_element :</span>
<span class="sd">            Lifetime :</span>
<span class="sd">            Rydberg :</span>
<span class="sd">            BBR :</span>
<span class="sd">            C3 :</span>
<span class="sd">            C6 :</span>
<span class="sd">            Rbl :</span>
<span class="sd">            LeRoy_radius :</span>
<span class="sd">            Polarizability :</span>
<span class="sd">            Stark_Map :</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
        
    <span class="c1">#fields</span>
    <span class="n">Energy</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;Hz&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">})</span>
    <span class="n">Transition_freq</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;Hz&#39;</span><span class="p">})</span>
    <span class="n">Wavelength</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;nm&#39;</span><span class="p">})</span>
    <span class="n">Rabi_freq</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;Hz&#39;</span><span class="p">})</span>
    <span class="n">Dip_Mat_element</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;Hz&#39;</span><span class="p">})</span>
    <span class="n">Lifetime</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">})</span>
    <span class="n">Rydberg</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">})</span>
    <span class="n">BBR</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">})</span>
    <span class="n">C3</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;Hz/um^3&#39;</span><span class="p">})</span>
    <span class="n">C6</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;Hz/um^6&#39;</span><span class="p">})</span>
    <span class="n">Rbl</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;um&#39;</span><span class="p">})</span>
    <span class="n">LeRoy_radius</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;um&#39;</span><span class="p">})</span>
    <span class="n">Polarizability</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">})</span>
    <span class="n">Stark_Map</span> <span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;axis1&#39;</span><span class="p">:</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;axis2&#39;</span><span class="p">:</span><span class="s1">&#39;value&#39;</span><span class="p">})</span></div>


<span class="c1">#####################################################################################################</span>
<span class="c1">#atomicKernel AQiPT class</span>
<span class="c1">#####################################################################################################</span>
    
<span class="k">def</span> <span class="nf">convert_to_float</span><span class="p">(</span><span class="n">frac_str</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">frac_str</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">num</span><span class="p">,</span> <span class="n">denom</span> <span class="o">=</span> <span class="n">frac_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">leading</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="n">num</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">);</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">denom</span><span class="p">)</span>        
        <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">leading</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sign_mult</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sign_mult</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">leading</span><span class="p">)</span> <span class="o">+</span> <span class="n">sign_mult</span> <span class="o">*</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">denom</span><span class="p">));</span>

<span class="k">def</span> <span class="nf">orb2Int</span><span class="p">(</span><span class="n">orb</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">orb</span> <span class="o">==</span><span class="s1">&#39;S&#39;</span> 
            <span class="k">else</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">orb</span> <span class="o">==</span> <span class="s1">&#39;P&#39;</span> 
            <span class="k">else</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">orb</span> <span class="o">==</span> <span class="s1">&#39;D&#39;</span> 
            <span class="k">else</span> <span class="mi">3</span> <span class="k">if</span> <span class="n">orb</span> <span class="o">==</span> <span class="s1">&#39;F&#39;</span> 
            <span class="k">else</span> <span class="kc">None</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">intensity</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">w0</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">w0</span><span class="o">**</span><span class="mi">2</span><span class="p">));</span>

<span class="k">def</span> <span class="nf">lst2dic</span><span class="p">(</span><span class="n">ket</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Helper function for passing a list of strings or just one string describing the state, returning a dictionary</span>
<span class="sd">        with the labeled quantum numbers.</span>

<span class="sd">        Example: </span>

<span class="sd">            &#39;4P_1/2, 1/2&#39; -----&gt; {&#39;n&#39;: 4, &#39;l&#39;: 1, &#39;j&#39;: 0.5, &#39;s&#39;: 0.5}</span>
<span class="sd">            &#39;4P_1/2, 1/2, 1, -1&#39; -----&gt; {&#39;n&#39;: 4, &#39;l&#39;: 1, &#39;j&#39;: 0.5, &#39;s&#39;: 0.5, &#39;F&#39;: 1, &#39;mF&#39;: -1}</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ket</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">ket</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ket_lst</span><span class="o">=</span><span class="p">{};</span> <span class="n">nr_state</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
                    
                    <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">element</span><span class="p">:</span>

                        <span class="n">l_val</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">state</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">isupper</span><span class="p">()]);</span>
                        <span class="n">n_val</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="n">l_val</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
                        <span class="n">j_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">state</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span><span class="n">state</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)];</span>
                        <span class="n">s_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">state</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">state</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)];</span>
                        <span class="n">ket_lst</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">nr_state</span><span class="p">)]</span><span class="o">=</span><span class="p">({</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span> <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="p">),</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="p">)})</span>
                        <span class="n">nr_state</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>
                    <span class="k">return</span> <span class="n">ket_lst</span>

                <span class="k">except</span><span class="p">:</span>
                    <span class="n">ket_lst</span><span class="o">=</span><span class="p">{};</span> <span class="n">nr_state</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
                
                    <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">element</span><span class="p">:</span>

                        <span class="n">n_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
                        <span class="n">l_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
                        <span class="n">j_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
                        <span class="n">s_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
                        <span class="n">ket_lst</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">nr_state</span><span class="p">)]</span><span class="o">=</span><span class="p">({</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span> <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="p">),</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="p">)})</span>
                        <span class="n">nr_state</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">ket_lst</span>

        <span class="k">else</span><span class="p">:</span>
            
            <span class="n">l_val</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">ket</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">isupper</span><span class="p">()])</span>
            <span class="n">n_val</span> <span class="o">=</span> <span class="n">ket</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="n">l_val</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">j_val</span> <span class="o">=</span> <span class="n">ket</span><span class="p">[</span><span class="n">ket</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span><span class="n">ket</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
            <span class="n">s_val</span> <span class="o">=</span> <span class="n">ket</span><span class="p">[</span><span class="n">ket</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">ket</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;B:&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span> <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="p">),</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="p">)})</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span> <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="p">),</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="p">)}</span>
    <span class="k">except</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ket</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">ket</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ket_lst</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">nr_state</span> <span class="o">=</span> <span class="mi">0</span>

                    <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">element</span><span class="p">:</span>
                        <span class="n">l_val</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">state</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">isupper</span><span class="p">()])</span>
                        <span class="n">n_val</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="n">l_val</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">j_val</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">s_val</span><span class="p">,</span> <span class="n">F_val</span><span class="p">,</span> <span class="n">mF_val</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>

                        <span class="n">ket_lst</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">nr_state</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span>
                            <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span>
                            <span class="s1">&#39;j&#39;</span><span class="p">:</span> <span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                            <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                            <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">F_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                            <span class="s1">&#39;mF&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">mF_val</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                        <span class="p">}</span>
                        <span class="n">nr_state</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">ket_lst</span>

                <span class="k">except</span><span class="p">:</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">ket_lst</span><span class="o">=</span><span class="p">{};</span> <span class="n">nr_state</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
                    
                        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">element</span><span class="p">:</span>

                            <span class="n">n_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
                            <span class="n">l_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
                            <span class="n">j_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
                            <span class="n">s_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
                            <span class="n">F_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
                            <span class="n">mF_val</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
                            <span class="n">ket_lst</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">nr_state</span><span class="p">)]</span><span class="o">=</span><span class="p">({</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span> <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="p">),</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="p">),</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="n">F_val</span><span class="p">),</span> <span class="s1">&#39;mF&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="n">mF_val</span><span class="p">)})</span>
                            <span class="n">nr_state</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="n">ket_lst</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">element</span><span class="p">:</span>
                            <span class="n">l_val</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">state</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">isupper</span><span class="p">()])</span>
                            <span class="n">n_val</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="n">l_val</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="n">j_val</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="n">s_val</span><span class="p">,</span> <span class="n">F_val</span><span class="p">,</span> <span class="n">mF_val</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;E: &#39;</span><span class="p">,</span> <span class="p">{</span>
                                <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span>
                                <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span>
                                <span class="s1">&#39;j&#39;</span><span class="p">:</span> <span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                                <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                                <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">F_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                                <span class="s1">&#39;mF&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">mF_val</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                            <span class="p">})</span>
                            <span class="k">return</span> <span class="p">{</span>
                                <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span>
                                <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span>
                                <span class="s1">&#39;j&#39;</span><span class="p">:</span> <span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                                <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                                <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">F_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                                <span class="s1">&#39;mF&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">mF_val</span><span class="o">.</span><span class="n">strip</span><span class="p">())}</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">l_val</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">ket</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">isupper</span><span class="p">()])</span>
            <span class="n">n_val</span> <span class="o">=</span> <span class="n">ket</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="n">l_val</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">j_val</span> <span class="o">=</span> <span class="n">ket</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">s_val</span><span class="p">,</span> <span class="n">F_val</span><span class="p">,</span> <span class="n">mF_val</span> <span class="o">=</span> <span class="n">ket</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;F: &#39;</span><span class="p">,</span> <span class="p">{</span>
                <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span>
                <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span>
                <span class="s1">&#39;j&#39;</span><span class="p">:</span> <span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">F_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                <span class="s1">&#39;mF&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">mF_val</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="p">})</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span>
                <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span>
                <span class="s1">&#39;j&#39;</span><span class="p">:</span> <span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">F_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                <span class="s1">&#39;mF&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">mF_val</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="p">}</span>

<span class="k">def</span> <span class="nf">_lst2dic</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">        Helper function for passing a list of strings or just one string describing the state, returning a dictionary</span>
<span class="sd">        with the labeled quantum numbers.</span>

<span class="sd">        Example: </span>

<span class="sd">            &#39;4P_1/2, 1/2&#39; -----&gt; {&#39;n&#39;: 4, &#39;l&#39;: 1, &#39;j&#39;: 0.5, &#39;s&#39;: 0.5}</span>
<span class="sd">            &#39;4P_1/2, 1/2, 1, -1&#39; -----&gt; {&#39;n&#39;: 4, &#39;l&#39;: 1, &#39;j&#39;: 0.5, &#39;s&#39;: 0.5, &#39;F&#39;: 1, &#39;mF&#39;: -1}</span>
<span class="sd">        </span>
<span class="sd">        CASES:</span>
<span class="sd">        -----</span>
<span class="sd">        </span>
<span class="sd">        A: n,l,j,s</span>
<span class="sd">        B: n,l,j,s,F,mF</span>
<span class="sd">        </span>
<span class="sd">        case1 = [] : lst </span>
<span class="sd">        case2 = &#39;&#39; : str</span>
<span class="sd">        case3 = [&#39;&#39;,&#39;&#39;] : list of str</span>
<span class="sd">        case4 = [[],[]] : list of list</span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span><span class="c1">#case1</span>
        
        <span class="k">if</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">is_list_of_lists</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span><span class="c1">#case4</span>

            <span class="n">_dict2return</span> <span class="o">=</span> <span class="p">{};</span> <span class="n">_element_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="c1">#case4 A</span>
                    <span class="n">n_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
                    <span class="n">l_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
                    <span class="n">j_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
                    <span class="n">s_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
                    <span class="n">F_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
                    <span class="n">mF_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
                    <span class="n">_dict2return</span><span class="p">[</span><span class="n">_element_idx</span><span class="p">]</span> <span class="o">=</span>  <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="n">n_val</span><span class="p">,</span> 
                                                   <span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="n">l_val</span><span class="p">,</span> 
                                                   <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="n">j_val</span><span class="p">,</span> 
                                                   <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="n">s_val</span><span class="p">,</span>
                                                   <span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="n">F_val</span><span class="p">,</span>
                                                   <span class="s1">&#39;mF&#39;</span><span class="p">:</span><span class="n">mF_val</span><span class="p">};</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="c1">#case4 B</span>
                    <span class="n">n_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
                    <span class="n">l_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
                    <span class="n">j_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
                    <span class="n">s_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
                    <span class="n">_dict2return</span><span class="p">[</span><span class="n">_element_idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="n">n_val</span><span class="p">,</span> 
                                                  <span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="n">l_val</span><span class="p">,</span> 
                                                  <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="n">j_val</span><span class="p">,</span> 
                                                  <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="n">s_val</span><span class="p">};</span>  

                <span class="n">_element_idx</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>

            <span class="k">return</span> <span class="n">_dict2return</span>         
            
        <span class="k">elif</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">is_list_of_strings</span><span class="p">(</span><span class="n">lst</span><span class="p">):</span><span class="c1">#case3</span>

            <span class="n">_dict2return</span> <span class="o">=</span> <span class="p">{};</span> <span class="n">_element_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>

                <span class="k">try</span><span class="p">:</span><span class="c1">#case3 A                    </span>
                    <span class="n">l_val</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">element</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">isupper</span><span class="p">()]);</span>
                    <span class="n">n_val</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="n">l_val</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
                    <span class="n">j_val</span> <span class="o">=</span> <span class="n">element</span><span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span><span class="n">element</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)];</span>
                    <span class="n">s_val</span> <span class="o">=</span> <span class="n">element</span><span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">element</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)];</span>
                    <span class="n">_dict2return</span><span class="p">[</span><span class="n">_element_idx</span><span class="p">]</span> <span class="o">=</span>   <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span> 
                                                    <span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span> 
                                                    <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="p">),</span> 
                                                    <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="p">)}</span>
                <span class="k">except</span><span class="p">:</span><span class="c1">#case3 B                    </span>
                    <span class="n">l_val</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">element</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">isupper</span><span class="p">()]);</span>
                    <span class="n">n_val</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="n">l_val</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
                    <span class="n">j_val</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
                    <span class="n">s_val</span><span class="p">,</span> <span class="n">F_val</span><span class="p">,</span> <span class="n">mF_val</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:];</span>
                    <span class="n">_dict2return</span><span class="p">[</span><span class="n">_element_idx</span><span class="p">]</span> <span class="o">=</span>   <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span>
                                                    <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span>
                                                    <span class="s1">&#39;j&#39;</span><span class="p">:</span> <span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                                                    <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                                                    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">F_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                                                    <span class="s1">&#39;mF&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">mF_val</span><span class="o">.</span><span class="n">strip</span><span class="p">())}</span>

                <span class="n">_element_idx</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>

            <span class="k">return</span> <span class="n">_dict2return</span>  

        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1">#case1 B</span>
                    <span class="n">n_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
                    <span class="n">l_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
                    <span class="n">j_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
                    <span class="n">s_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
                    <span class="n">F_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
                    <span class="n">mF_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
                    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="n">n_val</span><span class="p">,</span> 
                            <span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="n">l_val</span><span class="p">,</span> 
                            <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="n">j_val</span><span class="p">,</span> 
                            <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="n">s_val</span><span class="p">,</span>
                            <span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="n">F_val</span><span class="p">,</span>
                            <span class="s1">&#39;mF&#39;</span><span class="p">:</span><span class="n">mF_val</span><span class="p">}</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="c1">#case1 B</span>
                    <span class="n">n_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
                    <span class="n">l_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
                    <span class="n">j_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
                    <span class="n">s_val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
                    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="n">n_val</span><span class="p">,</span> 
                            <span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="n">l_val</span><span class="p">,</span> 
                            <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="n">j_val</span><span class="p">,</span> 
                            <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="n">s_val</span><span class="p">}</span>
                
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Format not recognised.&#39;</span><span class="p">)</span>
     
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span> <span class="c1">#case2</span>
        
        <span class="k">try</span><span class="p">:</span><span class="c1">#case2 A            </span>
            <span class="n">l_val</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">lst</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">isupper</span><span class="p">()]);</span>
            <span class="n">n_val</span> <span class="o">=</span> <span class="n">lst</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="n">l_val</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
            <span class="n">j_val</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="n">lst</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span><span class="n">lst</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)];</span>
            <span class="n">s_val</span> <span class="o">=</span> <span class="n">lst</span><span class="p">[</span><span class="n">lst</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">lst</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)];</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span> 
                    <span class="s1">&#39;l&#39;</span><span class="p">:</span><span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span> 
                    <span class="s1">&#39;j&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="p">),</span> 
                    <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="p">)}</span>
        <span class="k">except</span><span class="p">:</span><span class="c1">#case2 B</span>
            <span class="n">l_val</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">lst</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">isupper</span><span class="p">()]);</span>
            <span class="n">n_val</span> <span class="o">=</span> <span class="n">lst</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="n">l_val</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
            <span class="n">j_val</span> <span class="o">=</span> <span class="n">lst</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
            <span class="n">s_val</span><span class="p">,</span> <span class="n">F_val</span><span class="p">,</span> <span class="n">mF_val</span> <span class="o">=</span> <span class="n">lst</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:];</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_val</span><span class="p">),</span>
                    <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="n">orb2Int</span><span class="p">(</span><span class="n">l_val</span><span class="p">),</span>
                    <span class="s1">&#39;j&#39;</span><span class="p">:</span> <span class="n">convert_to_float</span><span class="p">(</span><span class="n">j_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                    <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="n">convert_to_float</span><span class="p">(</span><span class="n">s_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">F_val</span><span class="o">.</span><span class="n">strip</span><span class="p">()),</span>
                    <span class="s1">&#39;mF&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">mF_val</span><span class="o">.</span><span class="n">strip</span><span class="p">())}</span>

<span class="k">class</span> <span class="nc">atomicKernel</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT class that introduce the notion of the atomic physics into the simulations executed with atomicModel() class.</span>
<span class="sd">        The class allows to add all the constrains set by the physics of the system (e.g., neutral and Rydberg atoms). The</span>
<span class="sd">        use of the atomicKernel class to generate new atomicModel class-objects open the oportunity to have more realistic </span>
<span class="sd">        and precise simulation of the systems, specially when the system is extended into arrays of qubits. atomicQRegister class.</span>
<span class="sd">        </span>
<span class="sd">        This class can be feed with precise information given by the atomicSpec class.</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            kernelname :</span>
<span class="sd">            element :</span>
<span class="sd">            states :</span>
<span class="sd">            nrState :</span>
<span class="sd">            labsetup :</span>
<span class="sd">            atomSpecs :</span>
<span class="sd">            couplings :</span>
<span class="sd">            detunings :</span>
<span class="sd">            dissipators :</span>
<span class="sd">            params4AMs :</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            kernel2Model :</span>
<span class="sd">            loadSpec :</span>
<span class="sd">            getRabi :</span>
<span class="sd">            getGamma :</span>
<span class="sd">            __updateParams4AMs :</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">statelst</span><span class="p">,</span> <span class="n">labsetup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">atomSpec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;default_KernelName&#39;</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">kernelname</span> <span class="o">=</span> <span class="n">label</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="p">[</span><span class="n">arc</span><span class="o">.</span><span class="n">Hydrogen</span><span class="p">()</span> <span class="k">if</span> <span class="n">element</span> <span class="o">==</span> <span class="s1">&#39;Hydrogen&#39;</span>
                        <span class="k">else</span> <span class="n">arc</span><span class="o">.</span><span class="n">Lithium6</span><span class="p">()</span> <span class="k">if</span> <span class="n">element</span> <span class="o">==</span> <span class="s1">&#39;Lithium6&#39;</span>
                        <span class="k">else</span> <span class="n">arc</span><span class="o">.</span><span class="n">Lithium7</span><span class="p">()</span> <span class="k">if</span> <span class="n">element</span> <span class="o">==</span> <span class="s1">&#39;Lithium7&#39;</span>
                        <span class="k">else</span> <span class="n">arc</span><span class="o">.</span><span class="n">Sodium</span><span class="p">()</span> <span class="k">if</span> <span class="n">element</span> <span class="o">==</span> <span class="s1">&#39;Sodium&#39;</span>
                        <span class="k">else</span> <span class="n">arc</span><span class="o">.</span><span class="n">Potassium39</span><span class="p">()</span> <span class="k">if</span> <span class="n">element</span> <span class="o">==</span> <span class="s1">&#39;Potassium39&#39;</span>
                        <span class="k">else</span> <span class="n">arc</span><span class="o">.</span><span class="n">Potassium40</span><span class="p">()</span> <span class="k">if</span> <span class="n">element</span> <span class="o">==</span> <span class="s1">&#39;Potassium40&#39;</span>
                        <span class="k">else</span> <span class="n">arc</span><span class="o">.</span><span class="n">Potassium41</span><span class="p">()</span> <span class="k">if</span> <span class="n">element</span> <span class="o">==</span> <span class="s1">&#39;Potassium41&#39;</span>
                        <span class="k">else</span> <span class="n">arc</span><span class="o">.</span><span class="n">Rubidium85</span><span class="p">()</span> <span class="k">if</span> <span class="n">element</span> <span class="o">==</span> <span class="s1">&#39;Rubidium85&#39;</span>
                        <span class="k">else</span> <span class="n">arc</span><span class="o">.</span><span class="n">Rubidium87</span><span class="p">()</span> <span class="k">if</span> <span class="n">element</span> <span class="o">==</span> <span class="s1">&#39;Rubidium87&#39;</span>
                        <span class="k">else</span> <span class="n">arc</span><span class="o">.</span><span class="n">Caesium</span><span class="p">()</span> <span class="k">if</span> <span class="n">element</span> <span class="o">==</span> <span class="s1">&#39;Caesium&#39;</span>
                        <span class="k">else</span> <span class="kc">None</span> <span class="p">][</span><span class="mi">0</span><span class="p">];</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="n">lst2dic</span><span class="p">(</span><span class="n">statelst</span><span class="p">);</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nrStates</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">statelst</span><span class="p">);</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">labsetup</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">labsetup</span><span class="o">.</span><span class="n">items</span><span class="p">()));</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atomSpecs</span> <span class="o">=</span> <span class="n">atomSpec</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">couplings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detunings</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dissipators</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params4AMs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;couplings&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">couplings</span><span class="p">,</span>
                           <span class="s1">&#39;detunings&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">detunings</span><span class="p">,</span>
                           <span class="s1">&#39;dissipators&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dissipators</span><span class="p">};</span> <span class="c1">#wrapping dynamic params in dictionary</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_historyAM</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="k">def</span> <span class="nf">kernel2Model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">AM</span><span class="p">,</span> <span class="n">EXTatomicSpec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">newName</span><span class="o">=</span><span class="s1">&#39;default_NewModel&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            atomicKernel method to generate new atomicModel based in AMO physics estimations e.g., python</span>
<span class="sd">            packages or atomic specifications.</span>
<span class="sd">            </span>
<span class="sd">            INPUTS:</span>
<span class="sd">            ------</span>
<span class="sd">                AM :</span>
<span class="sd">                EXTatomicSpec :</span>
<span class="sd">                newName :</span>
<span class="sd">                </span>
<span class="sd">            OUTPUTS:</span>
<span class="sd">            --------</span>
<span class="sd">                atomicModel() class</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="n">EXTatomicSpec</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomSpecs</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
                
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No atomicSpec found. Embedding kernel in model with ARC </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="c1">#### creates COUPLINGS for NEW atomicModel() from atomicKernel() ####</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">couplings</span> <span class="o">=</span> <span class="n">AM</span><span class="o">.</span><span class="n">dynParams</span><span class="p">[</span><span class="s1">&#39;couplings&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">();</span> <span class="c1">#copy of atomicModel dynparams for protect AM values</span>
                <span class="n">_newCoupling</span><span class="o">=</span><span class="p">{};</span>
                <span class="k">for</span> <span class="n">label</span><span class="p">,</span><span class="n">coupling</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">couplings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                    <span class="n">_istate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">coupling</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])];</span> <span class="c1">#[list values] [map coupling] [1st edge: state ith]</span>
                    <span class="n">_jstate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">coupling</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])];</span> <span class="c1">#[list values] [map coupling] [2nd edge: state jth]</span>


                    <span class="n">_OmegaR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRabi</span><span class="p">(</span><span class="n">_istate</span><span class="p">,</span> <span class="n">_jstate</span><span class="p">);</span> <span class="c1">#calculate Rabi freq based in atomicKernel()</span>

                    <span class="n">_newCoupling</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">label</span><span class="p">:</span> <span class="p">[</span><span class="n">coupling</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">_OmegaR</span><span class="p">,</span> <span class="n">coupling</span><span class="p">[</span><span class="mi">2</span><span class="p">]]});</span> <span class="c1">#substitute value of the new Rabi freq</span>



                <span class="c1">#### creates DISSIPATORS for NEW atomicModel() from atomicKernel() ####</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">dissipators</span> <span class="o">=</span> <span class="n">AM</span><span class="o">.</span><span class="n">dynParams</span><span class="p">[</span><span class="s1">&#39;dissipators&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">();</span> <span class="c1">#copy of atomicModel dynparams for protect AM values</span>
                <span class="n">_newDissipator</span><span class="o">=</span><span class="p">{};</span>
                <span class="k">for</span> <span class="n">label</span><span class="p">,</span><span class="n">dissipator</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dissipators</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                    <span class="n">_istate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">dissipator</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])];</span> <span class="c1">#[list values] [map coupling] [1st edge: state ith]</span>
                    <span class="n">_jstate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">dissipator</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])];</span> <span class="c1">#[list values] [map coupling] [2nd edge: state jth]</span>

                    <span class="c1">#check rules</span>
    <span class="c1">#                 print(int(abs(_istate[&#39;l&#39;]-_jstate[&#39;l&#39;])), int(abs(_istate[&#39;j&#39;]-_jstate[&#39;j&#39;])), int(abs(_istate[&#39;s&#39;]-_jstate[&#39;s&#39;])))</span>

                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">_istate</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">_jstate</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]))</span><span class="o">==+</span><span class="mi">1</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">_istate</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">_jstate</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]))</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span> <span class="c1">#Delta l = +- 1</span>
                        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">_istate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">_jstate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">]))</span><span class="o">==+</span><span class="mi">1</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">_istate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">_jstate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">]))</span><span class="o">==-</span><span class="mi">1</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">_istate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">_jstate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">]))</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="c1">#Delta l = 0, +- 1</span>
                            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">_istate</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">_jstate</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">]))</span><span class="o">==+</span><span class="mi">1</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">_istate</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">_jstate</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">]))</span><span class="o">==-</span><span class="mi">1</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">_istate</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">_jstate</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">]))</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="c1">#Delta l = 0, +- 1</span>
                                <span class="n">_Gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGamma</span><span class="p">(</span><span class="n">_istate</span><span class="p">,</span> <span class="n">_jstate</span><span class="p">);</span> <span class="c1">#calculate Spontaneous decay based in atomicKernel()</span>
                                <span class="n">_newDissipator</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">label</span><span class="p">:</span> <span class="p">[</span><span class="n">dissipator</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">_Gamma</span><span class="p">]});</span> <span class="c1">#substitute value of the new Dissipator</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">_gamma</span> <span class="o">=</span> <span class="n">dissipator</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="c1">#inherits dephasing rate based in atomicKernel()</span>
                        <span class="n">_newDissipator</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">label</span><span class="p">:</span> <span class="p">[</span><span class="n">dissipator</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">_gamma</span><span class="p">]});</span> <span class="c1">#substitute value of the new Dissipator</span>



                <span class="c1">#### creates DETUNINGS FOR NEW atomicModel() from atomicKernel() ####</span>
<span class="w">                </span><span class="sd">&#39;&#39;&#39;creating list of new values of detuning given by the labsetup dict, where it finds a &#39;AOM&#39; keyword&#39;&#39;&#39;</span>

                <span class="n">_newDetuningslst</span><span class="o">=</span><span class="p">[];</span> <span class="n">_idx_det</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labsetup</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="s1">&#39;LASER&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                        <span class="n">value_atom</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s1">&#39;Frequency&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s1">&#39;AOM&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                        <span class="n">_newDetuningslst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;Frequency_resonance_scan&#39;</span><span class="p">]);</span>

                    <span class="n">_idx_det</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>
                    <span class="k">if</span> <span class="n">_idx_det</span><span class="o">&gt;=</span><span class="nb">len</span><span class="p">(</span><span class="n">AM</span><span class="o">.</span><span class="n">dynParams</span><span class="p">[</span><span class="s1">&#39;detunings&#39;</span><span class="p">]):</span>
                        <span class="k">break</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">detunings</span> <span class="o">=</span> <span class="n">AM</span><span class="o">.</span><span class="n">dynParams</span><span class="p">[</span><span class="s1">&#39;detunings&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">();</span> <span class="c1">#copy of atomicModel dynparams for protect AM values</span>

                <span class="n">_newDetuning</span><span class="o">=</span><span class="p">{};</span> <span class="n">_idx_det</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
                <span class="k">for</span> <span class="n">label</span><span class="p">,</span><span class="n">detuning</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">detunings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">_newDetuning</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">label</span><span class="p">:</span> <span class="p">[</span><span class="n">detuning</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">_newDetuningslst</span><span class="p">[</span><span class="n">_idx_det</span><span class="p">],</span> <span class="n">detuning</span><span class="p">[</span><span class="mi">2</span><span class="p">]]});</span>
                    <span class="n">_idx_det</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>


                <span class="c1">#### update params for atomicModels() ####</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">couplings</span> <span class="o">=</span> <span class="n">_newCoupling</span><span class="p">;</span> <span class="c1">#substitute of new couplings in atomicKernel() couplings specs</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">detunings</span> <span class="o">=</span> <span class="n">_newDetuning</span><span class="p">;</span> <span class="c1">#substitute of new detunings in atomicKernel() detunings specs</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dissipators</span> <span class="o">=</span> <span class="n">_newDissipator</span><span class="p">;</span> <span class="c1">#substitute of new dissipators in atomicKernel() dissipators specs</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__updateParams4AMs</span><span class="p">();</span>
                
                <span class="n">__NewAM</span> <span class="o">=</span> <span class="n">atomicModel</span><span class="p">(</span><span class="n">AM</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nrStates</span><span class="p">,</span> <span class="n">AM</span><span class="o">.</span><span class="n">_psi0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">params4AMs</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">newName</span><span class="p">);</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_historyAM</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">__NewAM</span><span class="p">);</span> <span class="c1">#storing new atomic model in kernel history</span>
                
                <span class="k">return</span> <span class="n">__NewAM</span>
            
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;atomicSpec found in Kernel. Embedding kernel in model </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="c1">## embeding here from own kernel&#39;s atomic spec</span>
        <span class="k">else</span><span class="p">:</span>
            
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;atomicSpec provided. Embedding kernel in model </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loadSpec</span><span class="p">(</span><span class="n">EXTatomicSpec</span><span class="p">);</span>
            <span class="c1">## embeding here from external specs</span>
            
    <span class="k">def</span> <span class="nf">loadSpec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atomSpec</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            atomicKernel method for loading atomic specifications (atomicSpecs-class) into kernel to be use for new atomicModel-class. </span>
<span class="sd">            It use the input specs from constructor of atomicKernel-class or a new one as input of the method.</span>
<span class="sd">            </span>
<span class="sd">            INPUTS:</span>
<span class="sd">            -------</span>
<span class="sd">            </span>
<span class="sd">                atomSpec : </span>
<span class="sd">            </span>
<span class="sd">            </span>
<span class="sd">            OUTPUTS:</span>
<span class="sd">            --------</span>
<span class="sd">            </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">atomSpec</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomSpecs</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: Atomic specifications not found.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Specifications loaded into &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernelname</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atomSpecs</span> <span class="o">=</span> <span class="n">atomSpec</span><span class="o">.</span><span class="n">copy</span><span class="p">();</span>
        
    <span class="k">def</span> <span class="nf">getRabi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">istate</span><span class="p">,</span> <span class="n">jstate</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            atomicKernel method for calculating Rabi Frequency using ARC python library.</span>
<span class="sd">            </span>
<span class="sd">            INPUTS:</span>
<span class="sd">            ------</span>
<span class="sd">            </span>
<span class="sd">                istate : </span>
<span class="sd">                jstate :</span>
<span class="sd">            </span>
<span class="sd">            </span>
<span class="sd">            OUTPUTS:</span>
<span class="sd">            --------</span>
<span class="sd">            </span>
<span class="sd">            </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">getDipoleMatrixElement</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">istate</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]),</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">],</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">],</span> <span class="n">istate</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">],</span>
                                                   <span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">],</span> <span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">],</span> <span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">],</span> <span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;s&#39;</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span><span class="c1">#*(np.sqrt(2*intensity_MW/e0*c )/(2*np.pi*1e9))</span>
    
    <span class="k">def</span> <span class="nf">getGamma</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">istate</span><span class="p">,</span> <span class="n">jstate</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            atomicKernel method for calculating Natural life-time using ARC python library.</span>
<span class="sd">            </span>
<span class="sd">            INPUTS:</span>
<span class="sd">            ------</span>
<span class="sd">            </span>
<span class="sd">                istate : </span>
<span class="sd">                jstate :</span>
<span class="sd">            </span>
<span class="sd">            </span>
<span class="sd">            OUTPUTS:</span>
<span class="sd">            --------</span>
<span class="sd">            </span>
<span class="sd">            </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="mf">1e-6</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">getStateLifetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]),</span> <span class="n">jstate</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__updateParams4AMs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            atomicKernel method for updating values of input parameters for atomicModel class</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params4AMs</span><span class="p">[</span><span class="s1">&#39;couplings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">couplings</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params4AMs</span><span class="p">[</span><span class="s1">&#39;detunings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detunings</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params4AMs</span><span class="p">[</span><span class="s1">&#39;dissipators&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dissipators</span><span class="p">;</span>


<span class="c1">#####################################################################################################</span>
<span class="c1">#hardwareSpecs AQiPT class</span>
<span class="c1">#####################################################################################################</span>

<div class="viewcode-block" id="hardwareSpecs">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs">[docs]</a>
<span class="k">class</span> <span class="nc">hardwareSpecs</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT class that use a JSON parser of real setup and instantiate the different optical and</span>
<span class="sd">        electronic elements of the setup. The class </span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_author</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_affiliation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_website</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dateCreation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_comments</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLSType</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;AOM&quot;</span><span class="p">:</span><span class="mh">0xf4240</span><span class="p">,</span>
                              <span class="s2">&quot;laser&quot;</span><span class="p">:</span><span class="mh">0xf4241</span><span class="p">,</span>
                              <span class="s2">&quot;laser-aux&quot;</span><span class="p">:</span><span class="mh">0xf4242</span><span class="p">,</span>
                              <span class="s2">&quot;camera&quot;</span><span class="p">:</span><span class="mh">0xf4243</span><span class="p">,</span>
                              <span class="s2">&quot;awg&quot;</span><span class="p">:</span><span class="mh">0xf4244</span><span class="p">,</span>
                              <span class="s2">&quot;dds&quot;</span><span class="p">:</span><span class="mh">0xf4245</span><span class="p">,</span>
                              <span class="s2">&quot;IQmixer&quot;</span><span class="p">:</span><span class="mh">0xf4246</span><span class="p">,</span>
                              <span class="s2">&quot;dmd&quot;</span><span class="p">:</span><span class="mh">0xf4247</span><span class="p">,</span>
                              <span class="s2">&quot;shutter&quot;</span><span class="p">:</span><span class="mh">0xf4248</span><span class="p">,</span>
                              <span class="s2">&quot;mixer&quot;</span><span class="p">:</span><span class="mh">0xf4249</span><span class="p">,</span>
                              <span class="s2">&quot;electrode&quot;</span><span class="p">:</span><span class="mh">0x0f4250</span><span class="p">,</span>
                              <span class="s2">&quot;coil&quot;</span><span class="p">:</span><span class="mh">0x0f4251</span><span class="p">,</span>
                              <span class="s2">&quot;sensor&quot;</span><span class="p">:</span><span class="mh">0x0f4252</span><span class="p">,</span>
                              <span class="s2">&quot;AOD&quot;</span><span class="p">:</span><span class="mh">0x0f4253</span><span class="p">,</span>
                              <span class="s2">&quot;slm&quot;</span><span class="p">:</span><span class="mh">0x0f4254</span><span class="p">,</span>
                              <span class="s2">&quot;antenna&quot;</span><span class="p">:</span><span class="mh">0x0f4255</span>
                              <span class="p">};</span> <span class="c1">#memory reserved from &gt;hex(1M) </span>

                              <span class="c1">#add switch, AODs, change dds-&gt;synthetizer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="o">.</span><span class="n">items</span><span class="p">()};</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_IDs_bench</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>

<div class="viewcode-block" id="hardwareSpecs.loadSpecs">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.loadSpecs">[docs]</a>
    <span class="k">def</span> <span class="nf">loadSpecs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">directory</span><span class="o">.</span><span class="n">hardware_specs_dir</span><span class="p">,</span> <span class="n">printON</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        
        <span class="c1">#load hardware_specs JSON file</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;hardware_specs_demo.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">specs_file</span><span class="p">:</span>
            <span class="n">hardware_specs</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">specs_file</span><span class="p">);</span>
            <span class="k">if</span> <span class="n">printON</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">hardware_specs</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span> <span class="o">=</span> <span class="n">hardware_specs</span><span class="p">;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_author</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">];</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_affiliation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;affiliation&#39;</span><span class="p">];</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_website</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;website&#39;</span><span class="p">];</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dateCreation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;created&#39;</span><span class="p">];</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_comments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;comments&#39;</span><span class="p">];</span> 
        <span class="k">pass</span>

        <span class="c1">#load listed devices</span>
        <span class="k">for</span> <span class="n">dev_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">:</span>
            <span class="n">dev_lst</span><span class="o">=</span><span class="p">[];</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;setup&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">dev_type</span> <span class="ow">in</span> <span class="n">element</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">dev_lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">);</span>
                     
            <span class="n">keys</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">vals</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">dev_lst</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">);</span>
                    <span class="n">val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
                <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">);</span>

            <span class="n">pd_dev</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">keys</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLSType</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd_dev</span><span class="p">);</span>

            <span class="k">if</span> <span class="n">printON</span><span class="p">:</span>
                <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">pd_dev</span><span class="o">.</span><span class="n">to_html</span><span class="p">()))</span></div>


<div class="viewcode-block" id="hardwareSpecs.printHeader">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.printHeader">[docs]</a>
    <span class="k">def</span> <span class="nf">printHeader</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> | </span><span class="si">{1}</span><span class="s1"> | </span><span class="si">{2}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_author</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_affiliation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_website</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Created: </span><span class="si">{0}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dateCreation</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Comments: </span><span class="si">{0}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comments</span><span class="p">))</span></div>


<div class="viewcode-block" id="hardwareSpecs.createAOM">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createAOM">[docs]</a>
    <span class="k">def</span> <span class="nf">createAOM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">aom_obj</span> <span class="o">=</span> <span class="n">AOM</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;AOM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aom_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>

    
<div class="viewcode-block" id="hardwareSpecs.createLaser">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createLaser">[docs]</a>
    <span class="k">def</span> <span class="nf">createLaser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">laser_obj</span> <span class="o">=</span> <span class="n">Laser</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;laser&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">laser_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>


<div class="viewcode-block" id="hardwareSpecs.createLaserAUX">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createLaserAUX">[docs]</a>
    <span class="k">def</span> <span class="nf">createLaserAUX</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">laserAUX_obj</span> <span class="o">=</span> <span class="n">LaserAUX</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;laser-aux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">laserAUX_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>


<div class="viewcode-block" id="hardwareSpecs.createCamera">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createCamera">[docs]</a>
    <span class="k">def</span> <span class="nf">createCamera</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">camera_obj</span> <span class="o">=</span> <span class="n">Camera</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;camera&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">camera_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>


<div class="viewcode-block" id="hardwareSpecs.createAWG">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createAWG">[docs]</a>
    <span class="k">def</span> <span class="nf">createAWG</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">awg_obj</span> <span class="o">=</span> <span class="n">AWG</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;awg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">awg_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>

   
<div class="viewcode-block" id="hardwareSpecs.createDDS">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createDDS">[docs]</a>
    <span class="k">def</span> <span class="nf">createDDS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">dds_obj</span> <span class="o">=</span> <span class="n">DDS</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;dds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dds_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>


<div class="viewcode-block" id="hardwareSpecs.createIQmixer">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createIQmixer">[docs]</a>
    <span class="k">def</span> <span class="nf">createIQmixer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">iqmixer_obj</span> <span class="o">=</span> <span class="n">IQmixer</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;IQmixer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iqmixer_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>


<div class="viewcode-block" id="hardwareSpecs.createDMD">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createDMD">[docs]</a>
    <span class="k">def</span> <span class="nf">createDMD</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">dmd_obj</span> <span class="o">=</span> <span class="n">DMD</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;dmd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dmd_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>


<div class="viewcode-block" id="hardwareSpecs.createSLM">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createSLM">[docs]</a>
    <span class="k">def</span> <span class="nf">createSLM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">slm_obj</span> <span class="o">=</span> <span class="n">SLM</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;slm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slm_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>


<div class="viewcode-block" id="hardwareSpecs.createShutter">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createShutter">[docs]</a>
    <span class="k">def</span> <span class="nf">createShutter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">shutter_obj</span> <span class="o">=</span> <span class="n">Shutter</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;shutter&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shutter_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>

    
<div class="viewcode-block" id="hardwareSpecs.createMixer">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createMixer">[docs]</a>
    <span class="k">def</span> <span class="nf">createMixer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">mixer_obj</span> <span class="o">=</span> <span class="n">Mixer</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;mixer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mixer_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>


    <span class="k">def</span> <span class="nf">createElectrode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">electrode_obj</span> <span class="o">=</span> <span class="n">Electrode</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;electrode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">electrode_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span>

<div class="viewcode-block" id="hardwareSpecs.createCoil">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createCoil">[docs]</a>
    <span class="k">def</span> <span class="nf">createCoil</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">coil_obj</span> <span class="o">=</span> <span class="n">Coil</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;coil&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coil_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>


<div class="viewcode-block" id="hardwareSpecs.createSensor">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createSensor">[docs]</a>
    <span class="k">def</span> <span class="nf">createSensor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">sensor_obj</span> <span class="o">=</span> <span class="n">Sensor</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;sensor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sensor_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>


<div class="viewcode-block" id="hardwareSpecs.createAOD">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createAOD">[docs]</a>
    <span class="k">def</span> <span class="nf">createAOD</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">aod_obj</span> <span class="o">=</span> <span class="n">AOD</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;AOD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aod_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>


<div class="viewcode-block" id="hardwareSpecs.createElectrode">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createElectrode">[docs]</a>
    <span class="k">def</span> <span class="nf">createElectrode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">electrode_obj</span> <span class="o">=</span> <span class="n">Electrode</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;electrode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">electrode_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>


<div class="viewcode-block" id="hardwareSpecs.createAntenna">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.createAntenna">[docs]</a>
    <span class="k">def</span> <span class="nf">createAntenna</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">antenna_obj</span> <span class="o">=</span> <span class="n">Antenna</span><span class="p">(</span><span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">);</span> <span class="c1">#creates sub-instance of the hardwareSpecs class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="s1">&#39;antenna&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">antenna_obj</span><span class="p">);</span> <span class="c1">#added to the list of hardware objects</span></div>


<div class="viewcode-block" id="hardwareSpecs.initSetup">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.hardwareSpecs.initSetup">[docs]</a>
    <span class="k">def</span> <span class="nf">initSetup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="k">for</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">:</span>

            <span class="n">dtype_idx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dtype</span><span class="p">);</span> <span class="c1">#index from hardware LUT</span>
            <span class="n">dtype_specs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hardwareLSType</span><span class="p">[</span><span class="n">dtype_idx</span><span class="p">];</span> <span class="c1">#set of specs of the dtype hardware</span>
            <span class="n">dtype_addrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="n">dtype</span><span class="p">];</span> <span class="c1">#LUT address allocation of dtype hardware</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dtype_specs</span><span class="p">)):</span>
                <span class="n">dtype_spec_i</span> <span class="o">=</span> <span class="n">dtype_specs</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="c1">#iterate over hardware elements</span>

                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;AOM&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createAOM</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">);</span>

                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;laser&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createLaser</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">]);</span>

                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;laser-aux&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createLaserAUX</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">]);</span>

                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;camera&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createCamera</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">]);</span>

                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;awg&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createAWG</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">]);</span>

                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;dds&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createDDS</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">]);</span>

                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;IQmixer&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createIQmixer</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">);</span>

                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;dmd&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createDMD</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">]);</span>

                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;shutter&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createShutter</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">]);</span>

                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;mixer&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createMixer</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">);</span>
                
                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;electrode&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createElectrode</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">]);</span>

                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;coil&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createCoil</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">]);</span>

                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;sensor&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createSensor</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">]);</span>

                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;AOD&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createAOD</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">);</span>

                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;slm&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createSLM</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">]);</span>

                <span class="k">if</span> <span class="n">dtype_addrs</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">[</span><span class="s1">&#39;antenna&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">createAntenna</span><span class="p">(</span><span class="n">specs</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="n">dtype_spec_i</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">]);</span></div>
</div>


<span class="c1">###===========================###</span>
<span class="c1">### hardwareSpecs sub-classes ###</span>
<span class="c1">###===========================###</span>

<span class="k">class</span> <span class="nc">AOM</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate AOMs on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">Laser</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate Lasers on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">LaserAUX</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate Auxiliar Lasers on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">Camera</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate Camera on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">AWG</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate AWGs on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>
 
<span class="k">class</span> <span class="nc">DDS</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate DDSs on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">IQmixer</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate IQ mixers on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">Mixer</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate Mixers on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">Shutter</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate Shutters on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">DMD</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate DMD on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">SLM</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate SLM on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">Electrode</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate Electrodes on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">Coil</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate Coil on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">Sensor</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate Electrodes on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">AOD</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate AODs on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>

<span class="k">class</span> <span class="nc">Antenna</span><span class="p">(</span><span class="n">hardwareSpecs</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT sub-class that use a JSON parser of real setup and instantiate Antennas on the setup.</span>
<span class="sd">        The class </span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>


<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specs</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specs</span> <span class="o">=</span> <span class="n">specs</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">driver</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;IDs&#39;</span><span class="p">:[],</span> <span class="s1">&#39;physical_address&#39;</span><span class="p">:[],</span> <span class="s1">&#39;assigned_track&#39;</span><span class="p">:</span> <span class="p">[]};</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>
        
<span class="c1">#####################################################################################################</span>
<span class="c1">#softwareSpecs AQiPT class</span>
<span class="c1">#####################################################################################################</span>

<div class="viewcode-block" id="softwareSpecs">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.softwareSpecs">[docs]</a>
<span class="k">class</span> <span class="nc">softwareSpecs</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT class that use a JSON parser of instructions protocol.</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_author</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_affiliation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_website</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dateCreation</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_comments</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;variables_UNITS&#39;</span><span class="p">,</span> <span class="s1">&#39;variables&#39;</span><span class="p">,</span> <span class="s1">&#39;tracks&#39;</span><span class="p">,</span> <span class="s1">&#39;sequences&#39;</span><span class="p">,</span> <span class="s1">&#39;instructions&#39;</span><span class="p">];</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_IDs_bench</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_python_waveforms</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>

    
<div class="viewcode-block" id="softwareSpecs.loadSpecs">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.softwareSpecs.loadSpecs">[docs]</a>
    <span class="k">def</span> <span class="nf">loadSpecs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">directory</span><span class="o">.</span><span class="n">compiler_dir</span><span class="p">,</span> <span class="n">printON</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        
        <span class="c1">#load software_specs JSON file</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;software_specs.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">specs_file</span><span class="p">:</span>
            <span class="n">software_specs</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">specs_file</span><span class="p">);</span>
            <span class="k">if</span> <span class="n">printON</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">software_specs</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span> <span class="o">=</span> <span class="n">software_specs</span><span class="p">;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_author</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">];</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_affiliation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;affiliation&#39;</span><span class="p">];</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_website</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;website&#39;</span><span class="p">];</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dateCreation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;created&#39;</span><span class="p">];</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_comments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;comments&#39;</span><span class="p">];</span> 
        <span class="k">pass</span></div>

        
<div class="viewcode-block" id="softwareSpecs.update">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.softwareSpecs.update">[docs]</a>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">waveforms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variables_UNITS</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">instructions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">configuration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_waveforms</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Update the software specifications (modify the current .json file of software_specs)</span>
<span class="sd">            with the Sequences (AQiPT.control.sequence -object), extracting the _API_sequences </span>
<span class="sd">            attribute and placing it in the specifications for later compilation of experiment</span>
<span class="sd">            (AQiPT.control.experiment -object) where schedule is compiled.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1">#updating variables</span>
        <span class="k">if</span> <span class="n">variables</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;variables&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">variables</span><span class="p">;</span>
        <span class="k">elif</span> <span class="n">variables</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">_variables_temp_dict</span> <span class="o">=</span> <span class="p">[];</span>

        <span class="c1">#updating waveforms e.g., tracks and sequences</span>
        <span class="k">if</span> <span class="n">waveforms</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">waveform</span> <span class="ow">in</span> <span class="n">waveforms</span><span class="p">:</span>
                
                <span class="c1">#try sequences</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">waveform</span><span class="p">,</span> <span class="n">control</span><span class="o">.</span><span class="n">sequence</span><span class="p">):</span>
                    
                    <span class="bp">self</span><span class="o">.</span><span class="n">_python_waveforms</span> <span class="o">=</span> <span class="n">waveforms</span><span class="p">;</span>

                    <span class="n">_instruction_name_list_</span> <span class="o">=</span> <span class="p">[];</span>

                    <span class="k">for</span> <span class="n">_idx_instruction</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">)):</span>
                        
                        <span class="c1">#storing specs for digital</span>
                        <span class="k">if</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;API_instruction_TYPE&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;DIGITAL&quot;</span><span class="p">:</span>
                            
                            <span class="n">_inst_type_</span> <span class="o">=</span> <span class="s1">&#39; DIGITAL&#39;</span><span class="p">;</span>
                            <span class="n">_instruction_name_i_</span> <span class="o">=</span> <span class="p">(</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">_inst_type_</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">);</span>
                            
                            <span class="n">_instruction_name_list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_instruction_name_i_</span><span class="p">);</span>

                            <span class="n">_spec_inst_i_</span> <span class="o">=</span> <span class="p">{</span><span class="n">_instruction_name_i_</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">1e4</span><span class="p">,</span> <span class="mf">1.5e4</span><span class="p">)),</span>
                                                                     <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;API_instruction_TYPE&#39;</span><span class="p">],</span>
                                                                     <span class="s2">&quot;CHANNEL&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">],</span>
                                                                     <span class="s2">&quot;ACTIVE&quot;</span><span class="p">:</span> <span class="s2">&quot;TRUE&quot;</span><span class="p">,</span>
                                                                     <span class="s2">&quot;TIME_FLAG&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;time_range&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                                                     <span class="s2">&quot;COMMAND&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">][</span><span class="s1">&#39;digital_cmd&#39;</span><span class="p">],</span>
                                                                     <span class="s2">&quot;SPECS&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span><span class="n">aqipt</span><span class="o">.</span><span class="n">remove_keywords_from_dict</span><span class="p">(</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;API_instruction_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;identifier&#39;</span><span class="p">,</span> <span class="s1">&#39;dyn_params&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">])},</span>
                                                                     <span class="s2">&quot;METADATA&quot;</span><span class="p">:</span> <span class="s2">&quot;Digital load from script.&quot;</span><span class="p">}};</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;instructions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_spec_inst_i_</span><span class="p">);</span> <span class="c1">#add instruction</span>
                            <span class="k">if</span> <span class="n">variables</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">_variables_temp_dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_timeflag&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">500e3</span><span class="p">,</span> <span class="mf">800e3</span><span class="p">)),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;time_range&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">:</span> <span class="s2">&quot;TIME_UNIT&quot;</span><span class="p">}});</span> <span class="c1"># random nr can be better implemented</span>
                                <span class="n">_variables_temp_dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_timeflags&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">500e3</span><span class="p">,</span> <span class="mf">800e3</span><span class="p">)),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;timeflags&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">:</span> <span class="s2">&quot;TIME_UNIT&quot;</span><span class="p">}});</span> <span class="c1"># random nr can be better implemented</span>


                        <span class="c1">#storing specs for digitals</span>
                        <span class="k">if</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;API_instruction_TYPE&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;DIGITALS&quot;</span><span class="p">:</span>
                            
                            <span class="n">_inst_type_</span> <span class="o">=</span> <span class="s1">&#39; DIGITALS&#39;</span><span class="p">;</span>
                            <span class="n">_instruction_name_i_</span> <span class="o">=</span> <span class="p">(</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">_inst_type_</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">);</span>
                            
                            <span class="n">_instruction_name_list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_instruction_name_i_</span><span class="p">);</span>

                            <span class="n">_spec_inst_i_</span> <span class="o">=</span> <span class="p">{</span><span class="n">_instruction_name_i_</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">1e4</span><span class="p">,</span> <span class="mf">1.5e4</span><span class="p">)),</span>
                                                                     <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;API_instruction_TYPE&#39;</span><span class="p">],</span>
                                                                     <span class="s2">&quot;CHANNEL&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">],</span>
                                                                     <span class="s2">&quot;ACTIVE&quot;</span><span class="p">:</span> <span class="s2">&quot;TRUE&quot;</span><span class="p">,</span>
                                                                     <span class="s2">&quot;TIME_FLAGS&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;timeflags&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                                                     <span class="s2">&quot;COMMAND&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">][</span><span class="s1">&#39;digital_cmd&#39;</span><span class="p">],</span>
                                                                     <span class="s2">&quot;SPECS&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span><span class="n">aqipt</span><span class="o">.</span><span class="n">remove_keywords_from_dict</span><span class="p">(</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;API_instruction_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;identifier&#39;</span><span class="p">,</span> <span class="s1">&#39;dyn_params&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">])},</span>
                                                                     <span class="s2">&quot;METADATA&quot;</span><span class="p">:</span> <span class="s2">&quot;Digital load from script.&quot;</span><span class="p">}};</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;instructions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_spec_inst_i_</span><span class="p">);</span> <span class="c1">#add instruction</span>
                            <span class="k">if</span> <span class="n">variables</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">_variables_temp_dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_timeflags&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">500e3</span><span class="p">,</span> <span class="mf">800e3</span><span class="p">)),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;timeflags&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">:</span> <span class="s2">&quot;TIME_UNIT&quot;</span><span class="p">}});</span> <span class="c1"># random nr can be better implemented</span>
                                <span class="n">_variables_temp_dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_timeflags&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">500e3</span><span class="p">,</span> <span class="mf">800e3</span><span class="p">)),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;timeflags&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">:</span> <span class="s2">&quot;TIME_UNIT&quot;</span><span class="p">}});</span> <span class="c1"># random nr can be better implemented</span>


                        <span class="c1">#storing specs for analog</span>
                        <span class="k">elif</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;API_instruction_TYPE&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;ANALOG&quot;</span><span class="p">:</span>

                            <span class="k">if</span> <span class="n">save_waveforms</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
                                <span class="n">_waveform</span> <span class="o">=</span> <span class="p">[</span><span class="n">_WAVEFORM</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">_WAVEFORM</span> <span class="ow">in</span> <span class="n">waveform</span><span class="o">.</span><span class="n">digiWaveformStack</span><span class="p">];</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">_waveform</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

                            <span class="n">_inst_type_</span> <span class="o">=</span> <span class="s1">&#39; ANALOG&#39;</span><span class="p">;</span>
                            <span class="n">_instruction_name_i_</span> <span class="o">=</span> <span class="p">(</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">_inst_type_</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                            
                            <span class="n">_instruction_name_list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_instruction_name_i_</span><span class="p">);</span>
                            
                            <span class="n">_spec_inst_i_</span> <span class="o">=</span> <span class="p">{</span><span class="n">_instruction_name_i_</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">1e4</span><span class="p">,</span> <span class="mf">1.5e4</span><span class="p">)),</span>
                                                                     <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;API_instruction_TYPE&#39;</span><span class="p">],</span>
                                                                     <span class="s2">&quot;CHANNEL&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">],</span>
                                                                     <span class="s2">&quot;WAVEFORM&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">_waveform</span><span class="p">),</span>
                                                                     <span class="s2">&quot;TIME_FLAG&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                                                     <span class="s2">&quot;COMMAND&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">][</span><span class="s1">&#39;analog_cmd&#39;</span><span class="p">],</span>
                                                                     <span class="s2">&quot;SPECS&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span><span class="n">aqipt</span><span class="o">.</span><span class="n">remove_keywords_from_dict</span><span class="p">(</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;API_instruction_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;identifier&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">])},</span>
                                                                     <span class="s2">&quot;METADATA&quot;</span><span class="p">:</span> <span class="s2">&quot;Analog load from script.&quot;</span><span class="p">}};</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;instructions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_spec_inst_i_</span><span class="p">);</span> <span class="c1">#add instruction</span>
                            <span class="k">if</span> <span class="n">variables</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">_variables_temp_dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_timeflags&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">500e3</span><span class="p">,</span> <span class="mf">800e3</span><span class="p">)),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">:</span> <span class="s2">&quot;TIME_UNIT&quot;</span><span class="p">}});</span> <span class="c1"># random nr can be better implemented</span>

                                <span class="n">_variables_temp_dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_amplitude&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">500e3</span><span class="p">,</span> <span class="mf">800e3</span><span class="p">)),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;analog_args&#39;</span><span class="p">][</span><span class="s1">&#39;amp&#39;</span><span class="p">],</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">:</span> <span class="s2">&quot;AMPLITUDE_UNIT&quot;</span><span class="p">}});</span> <span class="c1"># random nr can be better implemented</span>
                                <span class="n">_variables_temp_dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_initialtime&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">500e3</span><span class="p">,</span> <span class="mf">800e3</span><span class="p">)),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;analog_args&#39;</span><span class="p">][</span><span class="s1">&#39;t_o&#39;</span><span class="p">],</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">:</span> <span class="s2">&quot;TIME_UNIT&quot;</span><span class="p">}});</span> <span class="c1"># random nr can be better implemented</span>
                                <span class="n">_variables_temp_dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_pulsewidth&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">500e3</span><span class="p">,</span> <span class="mf">800e3</span><span class="p">)),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;analog_args&#39;</span><span class="p">][</span><span class="s1">&#39;width&#39;</span><span class="p">],</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">:</span> <span class="s2">&quot;TIME_UNIT&quot;</span><span class="p">}});</span> <span class="c1"># random nr can be better implemented</span>
                                <span class="n">_variables_temp_dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_timepulsewindow&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">500e3</span><span class="p">,</span> <span class="mf">800e3</span><span class="p">)),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;analog_args&#39;</span><span class="p">][</span><span class="s1">&#39;tp_window&#39;</span><span class="p">],</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">:</span> <span class="s2">&quot;TIME_UNIT&quot;</span><span class="p">}});</span> <span class="c1"># random nr can be better implemented</span>

                                <span class="n">_variables_temp_dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_sampling&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">500e3</span><span class="p">,</span> <span class="mf">800e3</span><span class="p">)),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;sampling&#39;</span><span class="p">],</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">:</span> <span class="s2">&quot;OTHER_UNIT&quot;</span><span class="p">}});</span> <span class="c1"># random nr can be better implemented</span>
                                <span class="n">_variables_temp_dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_carrierfrequency&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">500e3</span><span class="p">,</span> <span class="mf">800e3</span><span class="p">)),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;sampling&#39;</span><span class="p">],</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">:</span> <span class="s2">&quot;FREQUENCY_UNIT&quot;</span><span class="p">}});</span> <span class="c1"># random nr can be better implemented</span>
                                <span class="n">_variables_temp_dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_bitdepth&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">500e3</span><span class="p">,</span> <span class="mf">800e3</span><span class="p">)),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;sampling&#39;</span><span class="p">],</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">:</span> <span class="s2">&quot;OTHER_UNIT&quot;</span><span class="p">}});</span> <span class="c1"># random nr can be better implemented</span>

                        <span class="c1">#storing specs for analogs</span>
                        <span class="k">elif</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;API_instruction_TYPE&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;ANALOGS&quot;</span><span class="p">:</span>

                            <span class="k">if</span> <span class="n">save_waveforms</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
                                <span class="n">_waveform</span> <span class="o">=</span> <span class="p">[</span><span class="n">_WAVEFORM</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">_WAVEFORM</span> <span class="ow">in</span> <span class="n">waveform</span><span class="o">.</span><span class="n">digiWaveformStack</span><span class="p">];</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">_waveform</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>

                            <span class="n">_inst_type_</span> <span class="o">=</span> <span class="s1">&#39; ANALOGS&#39;</span><span class="p">;</span>
                            <span class="n">_instruction_name_i_</span> <span class="o">=</span> <span class="p">(</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">_inst_type_</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
                            
                            <span class="n">_instruction_name_list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_instruction_name_i_</span><span class="p">);</span>
                            
                            <span class="n">_spec_inst_i_</span> <span class="o">=</span> <span class="p">{</span><span class="n">_instruction_name_i_</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">1e4</span><span class="p">,</span> <span class="mf">1.5e4</span><span class="p">)),</span>
                                                                     <span class="s2">&quot;TYPE&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;API_instruction_TYPE&#39;</span><span class="p">],</span>
                                                                     <span class="s2">&quot;CHANNEL&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">],</span>
                                                                     <span class="s2">&quot;WAVEFORM&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">_waveform</span><span class="p">),</span>
                                                                     <span class="s2">&quot;TIME_FLAGS&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;timeflags&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                                                     <span class="s2">&quot;COMMAND&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;driver&#39;</span><span class="p">][</span><span class="s1">&#39;analog_cmd&#39;</span><span class="p">],</span>
                                                                     <span class="s2">&quot;SPECS&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span><span class="n">aqipt</span><span class="o">.</span><span class="n">remove_keywords_from_dict</span><span class="p">(</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;API_instruction_TYPE&#39;</span><span class="p">,</span> <span class="s1">&#39;identifier&#39;</span><span class="p">,</span> <span class="s1">&#39;dyn_params&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">])},</span>
                                                                     <span class="s2">&quot;METADATA&quot;</span><span class="p">:</span> <span class="s2">&quot;Analog load from script.&quot;</span><span class="p">}};</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;instructions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_spec_inst_i_</span><span class="p">);</span> <span class="c1">#add instruction</span>
                            <span class="k">if</span> <span class="n">variables</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">_variables_temp_dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_timeflags&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">500e3</span><span class="p">,</span> <span class="mf">800e3</span><span class="p">)),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;timeflags&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">:</span> <span class="s2">&quot;TIME_UNIT&quot;</span><span class="p">}});</span> <span class="c1"># random nr can be better implemented</span>
                                <span class="n">_variables_temp_dict</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_timeflags&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">500e3</span><span class="p">,</span> <span class="mf">800e3</span><span class="p">)),</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">waveform</span><span class="o">.</span><span class="n">_API_sequence</span><span class="p">[</span><span class="n">_idx_instruction</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;timeflags&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">:</span> <span class="s2">&quot;TIME_UNIT&quot;</span><span class="p">}});</span> <span class="c1"># random nr can be better implemented</span>

                    <span class="n">_spec_seq_i_</span> <span class="o">=</span> <span class="p">{</span><span class="n">waveform</span><span class="o">.</span><span class="n">label</span><span class="p">:{</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="nb">hex</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">)),</span>
                                                    <span class="s2">&quot;active&quot;</span><span class="p">:</span><span class="s2">&quot;True&quot;</span><span class="p">,</span> 
                                                    <span class="s2">&quot;INSTRUCTIONS&quot;</span><span class="p">:</span><span class="n">_instruction_name_list_</span><span class="p">}};</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;sequences&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_spec_seq_i_</span><span class="p">);</span> <span class="c1">#add sequence</span>


                <span class="c1"># elif isinstance(waveform, control.track):</span>

                <span class="c1">#     try: #try tracks</span>

                <span class="c1">#         _instruction_name_list_ = [];</span>

                <span class="c1">#         for _idx_instruction in range(len(waveform._API_sequence)):</span>

                <span class="c1">#             if &quot;risetime&quot; in waveform._API_sequence[_idx_instruction][1]:</span>

                <span class="c1">#                 _instruction_name_list_.append((waveform._API_sequence[_idx_instruction][1][&#39;name&#39;]+&#39; DIGITAL&#39;).replace(&quot; &quot;, &quot;_&quot;));</span>
                            
                <span class="c1">#             else:</span>

                <span class="c1">#                 _instruction_name_list_.append((waveform._API_sequence[_idx_instruction][1][&#39;name&#39;]+&#39; ANALOG&#39;).replace(&quot; &quot;, &quot;_&quot;));</span>


                <span class="c1">#         _spec_seq_i_ = {waveform.label:{&quot;ID&quot;: str(random.randint(500, 700)),</span>
                <span class="c1">#                                     &quot;active&quot;:&quot;True&quot;, </span>
                <span class="c1">#                                     &quot;INSTRUCTIONS&quot;:_instruction_name_list_}};</span>
                <span class="c1">#         self.specifications[&#39;tracks&#39;].append(_spec_seq_i_); #add track</span>

                <span class="c1">#     except:</span>
                <span class="c1">#         pass</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="s1">&#39;variables&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_variables_temp_dict</span><span class="p">;</span>

            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;software_specs.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">jsonFile</span><span class="p">:</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">specifications</span><span class="p">,</span> <span class="n">jsonFile</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;: &#39;</span><span class="p">))</span>

        <span class="c1">#updating variables</span>
        <span class="k">if</span> <span class="n">variables</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1">#updating variables units</span>
        <span class="k">if</span> <span class="n">variables_UNITS</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1">#updating instructions</span>
        <span class="k">if</span> <span class="n">instructions</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1">#updating configuration</span>
        <span class="k">if</span> <span class="n">configuration</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="k">pass</span></div>


<div class="viewcode-block" id="softwareSpecs.printHeader">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.softwareSpecs.printHeader">[docs]</a>
    <span class="k">def</span> <span class="nf">printHeader</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> | </span><span class="si">{1}</span><span class="s1"> | </span><span class="si">{2}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_author</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_affiliation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_website</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Created: </span><span class="si">{0}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dateCreation</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Comments: </span><span class="si">{0}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comments</span><span class="p">))</span></div>
</div>



<span class="c1">#####################################################################################################</span>
<span class="c1">#variables AQiPT class</span>
<span class="c1">#####################################################################################################</span>

<span class="k">class</span> <span class="nc">variables</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        AQiPT class that use the same JSON parser of instructions protocol to extract variables values</span>
<span class="sd">        and create a new object for non-default values during the experiment. Can be resave in the json</span>
<span class="sd">        file.</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            attribute :</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            method :</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Default&#39;</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">author</span><span class="o">=</span><span class="s1">&#39;AQiPT&#39;</span><span class="p">,</span> <span class="n">affiliation</span><span class="o">=</span><span class="s1">&#39;Default affiliation&#39;</span><span class="p">,</span> <span class="n">website</span><span class="o">=</span><span class="s1">&#39;Default website&#39;</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_author</span> <span class="o">=</span> <span class="n">author</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_affiliation</span> <span class="o">=</span> <span class="n">affiliation</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_website</span> <span class="o">=</span> <span class="n">website</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dateCreation</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">();</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_comments</span> <span class="o">=</span> <span class="n">comments</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_RAWvariables</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">();</span>
    
    <span class="k">def</span> <span class="nf">add_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">id_val</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;TIME_UNIT&#39;</span><span class="p">):</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
            <span class="k">if</span> <span class="n">id_val</span><span class="o">==</span><span class="s1">&#39;0x0&#39;</span><span class="p">:</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">id_val</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">rand_hex</span><span class="p">(</span><span class="n">ndigits</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span>
                    <span class="c1"># print(id_val)</span>
                    <span class="n">not_present</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">id_val</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">elem</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_RAWvariables</span><span class="o">.</span><span class="n">values</span><span class="p">());</span>
                    <span class="c1"># print(not_present)</span>
                    <span class="k">if</span> <span class="n">not_present</span><span class="p">:</span>
                        <span class="k">break</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_RAWvariables</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">name</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="n">id_val</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span> <span class="s1">&#39;UNIT&#39;</span><span class="p">:</span> <span class="n">unit</span><span class="p">}});</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Not valid variable&#39;</span><span class="p">)</span>
            <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">refresh_VARvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">VARname</span><span class="p">,</span> <span class="n">VARvalue</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_RAWvariables</span><span class="p">[</span><span class="n">VARname</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">VARvalue</span><span class="p">;</span>
        <span class="n">exec</span><span class="p">(</span><span class="s1">&#39;self.&#39;</span><span class="o">+</span><span class="n">VARname</span><span class="o">+</span><span class="s1">&#39; = VARvalue&#39;</span><span class="p">);</span>

    <span class="k">def</span> <span class="nf">refresh_VARunit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">VARname</span><span class="p">,</span> <span class="n">VARunit</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_RAWvariables</span><span class="p">[</span><span class="n">VARname</span><span class="p">][</span><span class="s1">&#39;UNIT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">VARunit</span><span class="p">;</span>

    <span class="k">def</span> <span class="nf">load_fromSpecs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">directory</span><span class="o">.</span><span class="n">compiler_dir</span><span class="p">,</span> <span class="n">printON</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        
        <span class="c1">#load variables from software_specs JSON file</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;software_specs.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">specs_file</span><span class="p">:</span>
            <span class="n">software_specs</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">specs_file</span><span class="p">);</span>
            <span class="k">if</span> <span class="n">printON</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">software_specs</span><span class="p">[</span><span class="s1">&#39;variables&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_RAWvariables</span> <span class="o">=</span> <span class="n">software_specs</span><span class="p">[</span><span class="s1">&#39;variables&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>


                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">software_specs</span><span class="p">[</span><span class="s1">&#39;variables&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">software_specs</span><span class="p">[</span><span class="s1">&#39;variables&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_variable</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_RAWvariables</span> <span class="o">=</span> <span class="n">software_specs</span><span class="p">[</span><span class="s1">&#39;variables&#39;</span><span class="p">];</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">software_specs</span><span class="p">[</span><span class="s1">&#39;variables_UNITS&#39;</span><span class="p">];</span>

        <span class="k">pass</span>  

    <span class="k">def</span> <span class="nf">printHeader</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> | </span><span class="si">{1}</span><span class="s1"> | </span><span class="si">{2}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_author</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_affiliation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_website</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Created: </span><span class="si">{0}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dateCreation</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Comments: </span><span class="si">{0}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_comments</span><span class="p">))</span>


<span class="c1">#####################################################################################################</span>
<span class="c1">#channelsBench AQiPT class</span>
<span class="c1">#####################################################################################################</span>

<div class="viewcode-block" id="IDsBench">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.IDsBench">[docs]</a>
<span class="k">class</span> <span class="nc">IDsBench</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">       ChannelsBench is an class that contains all the channels IDs plus the commands that can be </span>
<span class="sd">       executed from the device driver of that channel.</span>


<span class="sd">        ATTRIBUTES:</span>
<span class="sd">        -----------</span>
<span class="sd">            _HW_bench : bench for the IDs of the hardware elements</span>
<span class="sd">            _SW_bench : bench for the IDs of the software elements</span>
<span class="sd">            _CH_bench : bench for the IDS of the channels </span>
<span class="sd">            _AQiPT_bench : bench ofr the IDs reserved for AQiPT</span>
<span class="sd">            </span>
<span class="sd">        </span>
<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>
<span class="sd">            set_SW_bech : generates the hardware and channels ID benchs</span>
<span class="sd">            set_SW_bech : generates the software ID bench</span>
<span class="sd">            get_HW_bench : returns the hardware ID benches</span>
<span class="sd">            get_CH_bench : returns the channels ID benches</span>
<span class="sd">            get_SW_bench : returns the software ID benches</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_HW_bench</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">IDs</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_CH_bench</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">IDs</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_SW_bench</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">IDs</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_AQiPT_bench</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">IDs</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span>


    <span class="k">def</span> <span class="nf">_add_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_name</span><span class="p">,</span> <span class="n">bench</span><span class="p">,</span> <span class="n">_hex_ID</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">_python_memory_alloc</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">_subTYPE</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Add a new record/element of dataclass type (IDs), given the bench, the hexadecimal, python memory allocation and subtype</span>
<span class="sd">            of device is or coming from.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">_record</span> <span class="o">=</span> <span class="n">IDs</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">_name</span><span class="p">,</span> <span class="n">hex_ID</span><span class="o">=</span><span class="n">_hex_ID</span><span class="p">,</span> <span class="n">dec_ID</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">_hex_ID</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">16</span><span class="p">),</span> <span class="n">python_memory_alloc</span><span class="o">=</span><span class="n">_python_memory_alloc</span><span class="p">,</span> <span class="n">subTYPE</span><span class="o">=</span><span class="n">_subTYPE</span><span class="p">);</span>

        <span class="n">bench</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_record</span><span class="p">);</span>

<div class="viewcode-block" id="IDsBench.set_HW_bench">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.IDsBench.set_HW_bench">[docs]</a>
    <span class="k">def</span> <span class="nf">set_HW_bench</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specifications</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Set the bench for the HW and at the same time the channels located in the hardware. This is used by the specification </span>
<span class="sd">            parser of the API.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">for</span> <span class="n">TYPE</span> <span class="ow">in</span> <span class="n">specifications</span><span class="o">.</span><span class="n">hardwareTypes</span><span class="p">:</span>

            <span class="k">for</span> <span class="n">k_type</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">specifications</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">TYPE</span><span class="p">)])):</span>
                
                <span class="c1">#hardware bench</span>
                <span class="n">__name</span> <span class="o">=</span> <span class="n">specifications</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">TYPE</span><span class="p">)][</span><span class="n">k_type</span><span class="p">]</span><span class="o">.</span><span class="n">specs</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">TYPE</span><span class="p">)];</span> <span class="c1">#name</span>
                <span class="n">__hex_ID</span> <span class="o">=</span> <span class="n">specifications</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">TYPE</span><span class="p">)][</span><span class="n">k_type</span><span class="p">]</span><span class="o">.</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">];</span> <span class="c1">#id registered in the HW specifications JSON file</span>
                <span class="n">__python_memory_alloc</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">specifications</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">TYPE</span><span class="p">)][</span><span class="n">k_type</span><span class="p">]));</span> <span class="c1">#python memory allocation of hardware in HW_specs</span>
                <span class="n">__subTYPE</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">TYPE</span><span class="p">);</span> <span class="c1">#type of the device it belongs</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_add_record</span><span class="p">(</span><span class="n">_name</span><span class="o">=</span><span class="n">__name</span><span class="p">,</span> <span class="n">bench</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_HW_bench</span><span class="p">,</span> <span class="n">_hex_ID</span><span class="o">=</span><span class="n">__hex_ID</span><span class="p">,</span> <span class="n">_python_memory_alloc</span><span class="o">=</span><span class="n">__python_memory_alloc</span><span class="p">,</span> <span class="n">_subTYPE</span><span class="o">=</span><span class="n">__subTYPE</span><span class="p">);</span> <span class="c1">#creating and adding the new record of the HW dataclass</span>

                <span class="c1">#channels bench</span>
                <span class="k">try</span><span class="p">:</span>

                    <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
                    <span class="k">for</span> <span class="n">ch_id</span> <span class="ow">in</span> <span class="n">specifications</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">TYPE</span><span class="p">)][</span><span class="n">k_type</span><span class="p">]</span><span class="o">.</span><span class="n">specs</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;channels_IDs&#39;</span><span class="p">]:</span>
                        
                        <span class="n">__name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">TYPE</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">specifications</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">TYPE</span><span class="p">)][</span><span class="n">k_type</span><span class="p">]</span><span class="o">.</span><span class="n">specs</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">TYPE</span><span class="p">)])</span> <span class="o">+</span> <span class="s1">&#39;_CHANNEL_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
                        <span class="n">__CH_hex_ID</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ch_id</span><span class="p">);</span> <span class="c1">#id registered in the HW specifications JSON file</span>
                        <span class="n">__CH_python_memory_alloc</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">specifications</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">TYPE</span><span class="p">)][</span><span class="n">k_type</span><span class="p">]));</span> <span class="c1">#python memory allocation of hardware in HW_specs</span>
                        <span class="n">__CH_subTYPE</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">TYPE</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">specifications</span><span class="o">.</span><span class="n">hardwareLST</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">TYPE</span><span class="p">)][</span><span class="n">k_type</span><span class="p">]</span><span class="o">.</span><span class="n">specs</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">TYPE</span><span class="p">)]);</span> <span class="c1">#type of the device it belongs</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">_add_record</span><span class="p">(</span><span class="n">_name</span><span class="o">=</span><span class="n">__name</span><span class="p">,</span> <span class="n">bench</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_CH_bench</span><span class="p">,</span> <span class="n">_hex_ID</span><span class="o">=</span> <span class="n">__CH_hex_ID</span><span class="p">,</span> <span class="n">_python_memory_alloc</span><span class="o">=</span> <span class="n">__CH_python_memory_alloc</span><span class="p">,</span> <span class="n">_subTYPE</span><span class="o">=</span> <span class="n">__CH_subTYPE</span><span class="p">);</span> <span class="c1">#creating and adding the new record of the CH dataclass</span>
                        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span></div>


<div class="viewcode-block" id="IDsBench.set_SW_bench">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.IDsBench.set_SW_bench">[docs]</a>
    <span class="k">def</span> <span class="nf">set_SW_bench</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specifications</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Set the bench for the SW. This is used by the specification parser of the API.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">HEAD</span> <span class="ow">in</span> <span class="n">specifications</span><span class="o">.</span><span class="n">_headers</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">keyword</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">specifications</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">HEAD</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                    <span class="c1">#software bench</span>
                    <span class="n">__name</span> <span class="o">=</span> <span class="n">keyword</span><span class="p">;</span> <span class="c1">#name of the variable</span>
                    <span class="n">__hex_ID</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">];</span> <span class="c1">#id registered in the HW specifications JSON file</span>
                    <span class="n">__python_memory_alloc</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">specifications</span><span class="p">));</span> <span class="c1">#python memory allocation of hardware in HW_specs</span>
                    <span class="n">__subTYPE</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">HEAD</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">keyword</span><span class="p">);</span> <span class="c1">#type of the device it belongs</span>


                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_record</span><span class="p">(</span><span class="n">_name</span><span class="o">=</span><span class="n">__name</span><span class="p">,</span> <span class="n">bench</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_SW_bench</span><span class="p">,</span> <span class="n">_hex_ID</span><span class="o">=</span><span class="n">__hex_ID</span><span class="p">,</span> <span class="n">_python_memory_alloc</span><span class="o">=</span><span class="n">__python_memory_alloc</span><span class="p">,</span> <span class="n">_subTYPE</span><span class="o">=</span><span class="n">__subTYPE</span><span class="p">);</span> <span class="c1">#creating and adding the new record of the HW dataclass</span>

            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">try</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">k_type</span> <span class="ow">in</span> <span class="n">specifications</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">HEAD</span><span class="p">)][</span><span class="mi">0</span><span class="p">]:</span>

                    <span class="c1">#software bench</span>
                    <span class="n">__name</span> <span class="o">=</span> <span class="s1">&#39;Default&#39;</span><span class="p">;</span>
                    <span class="n">__hex_ID</span> <span class="o">=</span> <span class="n">k_type</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">];</span> <span class="c1">#id registered in the HW specifications JSON file</span>
                    <span class="n">__python_memory_alloc</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">specifications</span><span class="o">.</span><span class="n">specifications</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">HEAD</span><span class="p">)][</span><span class="mi">0</span><span class="p">]));</span> <span class="c1">#python memory allocation of hardware in SW_specs</span>
                    <span class="n">__subTYPE</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">HEAD</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">mydict</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">1</span><span class="p">]);</span> <span class="c1">#type of the device it belongs</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">_add_record</span><span class="p">(</span><span class="n">_name</span><span class="o">=</span><span class="n">__name</span><span class="p">,</span> <span class="n">bench</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_SW_bench</span><span class="p">,</span> <span class="n">_hex_ID</span><span class="o">=</span><span class="n">__hex_ID</span><span class="p">,</span> <span class="n">_python_memory_alloc</span><span class="o">=</span><span class="n">__python_memory_alloc</span><span class="p">,</span> <span class="n">_subTYPE</span><span class="o">=</span><span class="n">__subTYPE</span><span class="p">);</span> <span class="c1">#creating and adding the new record of the SW dataclass</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span></div>

    
<div class="viewcode-block" id="IDsBench.get_HW_bench">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.IDsBench.get_HW_bench">[docs]</a>
    <span class="k">def</span> <span class="nf">get_HW_bench</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Returns the Hardware bench of IDs.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_HW_bench</span></div>


<div class="viewcode-block" id="IDsBench.get_SW_bench">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.IDsBench.get_SW_bench">[docs]</a>
    <span class="k">def</span> <span class="nf">get_SW_bench</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Returns the Software bench of IDs.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_SW_bench</span></div>


<div class="viewcode-block" id="IDsBench.get_CH_bench">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.IDsBench.get_CH_bench">[docs]</a>
    <span class="k">def</span> <span class="nf">get_CH_bench</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Returns the Channels bench of IDs.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CH_bench</span></div>
</div>


<div class="viewcode-block" id="IDs">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.IDs">[docs]</a>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">IDs</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Special dataclass of AQiPT that stores the IDs of the channels of software, hardware, atom and other instances.</span>
<span class="sd">        </span>
<span class="sd">        ATTRIBUTES/FIELDS:</span>
<span class="sd">        ------------------</span>
<span class="sd">        </span>
<span class="sd">            hex_ID : hexadecimal ID value</span>
<span class="sd">            dec_ID : decimal ID value</span>
<span class="sd">            python_memory_alloc : Python memory allocation</span>
<span class="sd">            subTYPE : sub-type of the ID e.g., awg, aom, etc</span>

<span class="sd">        METHODS:</span>
<span class="sd">        --------</span>

<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
        
    <span class="c1">#fields</span>
    <span class="n">name</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;Default&quot;</span><span class="p">)</span>
    <span class="n">hex_ID</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;0x0&quot;</span><span class="p">)</span>
    <span class="n">dec_ID</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;0x0&quot;</span><span class="p">)</span>
    <span class="n">python_memory_alloc</span> <span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;0x0&quot;</span><span class="p">)</span>
    <span class="n">subTYPE</span> <span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;Default&quot;</span><span class="p">)</span></div>


<span class="c1">###################################################################################################</span>
<span class="c1">#######################                 Middleware Kernel             #############################</span>
<span class="c1">###################################################################################################</span>

<span class="c1">#####################################################################################################</span>
<span class="c1">############################            TRANSPILER SECTION               ############################</span>
<span class="c1">#####################################################################################################</span>

<span class="kn">from</span> <span class="nn">AQiPT.modules.control</span> <span class="kn">import</span> <span class="n">AQiPTcontrol</span> <span class="k">as</span> <span class="n">control</span>

<span class="k">def</span> <span class="nf">merge_waveforms</span><span class="p">(</span><span class="n">waveforms</span> <span class="p">:</span><span class="nb">dict</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="c1"># coupling = {};</span>
    <span class="c1"># done = [];</span>
    <span class="c1"># k = 0;</span>

    <span class="c1"># values = list(waveforms.values())</span>
    <span class="c1"># for i in range(len(values)):</span>
    <span class="c1">#     if i in done: continue</span>
    <span class="c1">#     v1 = values[i];</span>

    <span class="c1">#     for j in range(len(values)):</span>
            
    <span class="c1">#         if i == j: continue</span>
            
    <span class="c1">#         v2 = values[j];</span>

    <span class="c1">#         # Matching the same levels of coupling</span>
    <span class="c1">#         if v2[0] == v1[0]:</span>
    <span class="c1">#             v1 = [v1[0], v1[1], np.add(v1[2], v2[2])];</span>
    <span class="c1">#             values[i] = v1;</span>
    <span class="c1">#             done.append(j);</span>

    <span class="c1">#     coupling[name+str(k)] = v1;</span>
    <span class="c1">#     done.append(i);</span>
    <span class="c1">#     k += 1;</span>
    <span class="c1">#--------#</span>

    <span class="n">coupling</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">done</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">waveforms</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">v1</span> <span class="o">=</span> <span class="n">vi</span>

        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">vj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">v2</span> <span class="o">=</span> <span class="n">vj</span>

            <span class="c1"># Matching the same levels of coupling</span>
            <span class="k">if</span> <span class="n">v2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">v1</span> <span class="o">=</span> <span class="p">[</span><span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">v2</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
                <span class="n">vi</span> <span class="o">=</span> <span class="n">v1</span>
                <span class="n">done</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>

        <span class="n">coupling</span><span class="p">[</span><span class="n">name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">v1</span>
        <span class="n">done</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">coupling</span>

<span class="k">def</span> <span class="nf">coupling_detuning_constructors</span><span class="p">(</span><span class="n">couplings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">tuple</span><span class="p">],</span>
                                   <span class="n">detunings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">tuple</span><span class="p">],</span>
                                   <span class="n">omega_coup</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                                   <span class="n">omega_detu</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Constructor of the couplings and detunings dictionaries.</span>
<span class="sd">        </span>
<span class="sd">        INPUTS</span>
<span class="sd">            couplings (List[float]): coupling list time dependency.</span>
<span class="sd">            detunings (List[float]): detuning list time dependency.</span>
<span class="sd">            omega_coup (int, optional): coupling amplitude. Defaults to 20.</span>
<span class="sd">            omega_detu (int, optional): coupling amplitude. Defaults to 0.</span>

<span class="sd">        OUTPUTS</span>
<span class="sd">            Tuple[dict, dict]: build dictionaries for couplings and detunings.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">coupling_dict</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">omega_coup</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coupling</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">couplings</span><span class="p">):</span>
            <span class="n">levels</span><span class="p">,</span> <span class="n">coupling</span> <span class="o">=</span> <span class="n">coupling</span><span class="p">;</span>
            <span class="n">coupling_dict</span><span class="p">[</span><span class="s2">&quot;Coupling&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">levels</span><span class="p">,</span> <span class="n">omega_coup</span><span class="p">,</span> <span class="n">coupling</span><span class="p">];</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">omega_coup</span><span class="p">,</span> <span class="n">List</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">omega_coup</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">couplings</span><span class="p">);</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coupling</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">couplings</span><span class="p">):</span>
            <span class="n">levels</span><span class="p">,</span> <span class="n">coupling</span> <span class="o">=</span> <span class="n">coupling</span><span class="p">;</span>
            <span class="n">coupling_dict</span><span class="p">[</span><span class="s2">&quot;Coupling&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">levels</span><span class="p">,</span> <span class="n">omega_coup</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">coupling</span><span class="p">];</span>

    <span class="n">detuning_dict</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">detuning</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">detunings</span><span class="p">):</span>
        <span class="n">levels</span><span class="p">,</span> <span class="n">detuning</span> <span class="o">=</span> <span class="n">detuning</span><span class="p">;</span>
        <span class="n">detuning_dict</span><span class="p">[</span><span class="s2">&quot;Detuning&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">levels</span><span class="p">,</span> <span class="n">omega_detu</span><span class="p">,</span> <span class="n">detuning</span><span class="p">];</span>

    <span class="k">return</span> <span class="n">coupling_dict</span><span class="p">,</span> <span class="n">detuning_dict</span>

<span class="k">def</span> <span class="nf">freq_given_phi</span><span class="p">(</span><span class="n">phi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">v_ct</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function that yields the right frequency for generating an angle of</span>
<span class="sd">    $\Phi_{11}$ under the interaction of strenght $V_{ct}$.</span>

<span class="sd">    INPUTS:</span>
<span class="sd">        phi (float): required angle.</span>
<span class="sd">        v_ct (float): interaction strength.</span>

<span class="sd">    OUTPUTS:</span>
<span class="sd">        float: resulting frequency.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">8</span><span class="p">);</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">);</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="o">+</span><span class="n">v_ct</span> <span class="o">*</span> <span class="mf">9.55717</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3614</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.3745</span> <span class="o">-</span> <span class="n">phi</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">freq</span>

<span class="c1">#####################################################################################################</span>
<span class="c1">#Rydberg schedules classes</span>
<span class="c1">#####################################################################################################</span>

<span class="c1"># plt.style.use(&quot;dark_background&quot;);</span>

<div class="viewcode-block" id="RydbergQubitSchedule">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.RydbergQubitSchedule">[docs]</a>
<span class="k">class</span> <span class="nc">RydbergQubitSchedule</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Class wrapper of the schedule for the Rydberg qubits and Rydberg quantum register.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        coupling_waveforms ():</span>
<span class="sd">        detuning_waveforms ():</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>

<span class="sd">        coupling_waveforms (): </span>
<span class="sd">        detuning_waveforms (): </span>
<span class="sd">        times (): </span>
<span class="sd">        </span>
<span class="sd">        _merge_pulses ():</span>
<span class="sd">        q_schedule ():</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coupling_waveforms</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">detuning_waveforms</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coupling_waveforms</span> <span class="o">=</span> <span class="n">coupling_waveforms</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detuning_waveforms</span> <span class="o">=</span> <span class="n">detuning_waveforms</span><span class="p">;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_merge_waveforms</span><span class="p">();</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_schedule</span> <span class="o">=</span> <span class="bp">self</span><span class="p">;</span>

        <span class="k">if</span> <span class="s2">&quot;backend&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">backend_config</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;backend&quot;</span><span class="p">];</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">backend_config</span><span class="p">,</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">BackendConfig</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span> <span class="o">=</span> <span class="n">backend_config</span><span class="p">;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">backend_config</span><span class="p">;</span>

        <span class="n">simulation_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">simulation_config</span><span class="p">;</span>
        <span class="n">sampling</span> <span class="o">=</span> <span class="n">simulation_config</span><span class="o">.</span><span class="n">sampling</span><span class="p">;</span>
        <span class="n">bitdepth</span> <span class="o">=</span> <span class="n">simulation_config</span><span class="o">.</span><span class="n">bitdepth</span><span class="p">;</span>
        <span class="n">t_max</span> <span class="o">=</span> <span class="n">simulation_config</span><span class="o">.</span><span class="n">time_simulation</span><span class="p">;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">general_params</span><span class="p">({</span><span class="s2">&quot;sampling&quot;</span><span class="p">:</span> <span class="n">sampling</span><span class="p">,</span> <span class="s2">&quot;bitdepth&quot;</span><span class="p">:</span> <span class="n">bitdepth</span><span class="p">,</span> <span class="s2">&quot;time_dyn&quot;</span><span class="p">:</span> <span class="n">t_max</span><span class="p">})</span><span class="o">.</span><span class="n">timebase</span><span class="p">();</span>

    <span class="k">def</span> <span class="nf">_merge_waveforms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Merge waveforms of the Couplings and Detunings.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coupling_waveforms</span> <span class="o">=</span> <span class="n">merge_waveforms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coupling_waveforms</span><span class="p">,</span> <span class="s1">&#39;Coupling&#39;</span><span class="p">);</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detuning_waveforms</span> <span class="o">=</span> <span class="n">merge_waveforms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detuning_waveforms</span><span class="p">,</span> <span class="s1">&#39;Detuning&#39;</span><span class="p">);</span>
        
<div class="viewcode-block" id="RydbergQubitSchedule.add_function">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.RydbergQubitSchedule.add_function">[docs]</a>
    <span class="k">def</span> <span class="nf">add_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_funct</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">idx</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameter</span> <span class="o">=</span> <span class="s2">&quot;coupling&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Sum waveforms of the Couplings and Detunings.</span>

<span class="sd">            INPUTS:</span>
<span class="sd">                funct (np.ndarray): function to be add.</span>
<span class="sd">                where (str): index where function needs to be add.</span>
<span class="sd">                funct_type (str, optional): type of function. Defaults to &quot;coupling&quot;.</span>

<span class="sd">            OUTPUTS:</span>
<span class="sd">                ValueError: unspecified function type.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="n">parameter</span> <span class="o">==</span> <span class="s2">&quot;coupling&quot;</span><span class="p">:</span>
            <span class="n">_schedule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coupling_waveforms</span><span class="p">;</span>
        <span class="k">elif</span> <span class="n">parameter</span> <span class="o">==</span> <span class="s2">&quot;detuning&quot;</span><span class="p">:</span>
            <span class="n">_schedule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detuning_waveforms</span><span class="p">;</span>

        <span class="n">_funct</span> <span class="o">=</span> <span class="n">_schedule</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>
        <span class="n">_funct</span> <span class="o">+=</span> <span class="n">new_funct</span><span class="p">;</span>
        
        <span class="n">_schedule</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">_funct</span><span class="p">;</span></div>

        
<div class="viewcode-block" id="RydbergQubitSchedule.add_coupling">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.RydbergQubitSchedule.add_coupling">[docs]</a>
    <span class="k">def</span> <span class="nf">add_coupling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_schedule</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">idx</span> <span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameter</span> <span class="o">=</span> <span class="s2">&quot;coupling&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Merge waveforms of the Couplings and Detunings.</span>

<span class="sd">            INPUTS</span>
<span class="sd">                new_schedule (dict): schedule que se desea agregar.</span>
<span class="sd">                idx (str): index where the schedule needs to be add.</span>
<span class="sd">                funct_type (str, optional): function type Defaults to &quot;coupling&quot;.</span>

<span class="sd">            OUTPUTS</span>
<span class="sd">                ValueError: function type.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;coupling&quot;</span><span class="p">:</span>
            <span class="n">_schedule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coupling_waveforms</span><span class="p">;</span>
        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;detuning&quot;</span><span class="p">:</span>
            <span class="n">_schedule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detuning_waveforms</span><span class="p">;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span>
            
        <span class="n">_schedule</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_schedule</span><span class="p">[</span><span class="n">idx</span><span class="p">];</span>    </div>


<div class="viewcode-block" id="RydbergQubitSchedule.plot_couplings">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.RydbergQubitSchedule.plot_couplings">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_couplings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotON</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">amp</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Plot couplings function.</span>

<span class="sd">            INPUTS:</span>
<span class="sd">                plot (bool, optional): show plot. Defaults to True.</span>
<span class="sd">                name (str, optional): plots label. Defaults to &quot;&quot;.</span>
<span class="sd">                phase (bool, optional): show phases of waveforms. Defaults to True.</span>
<span class="sd">                amp (bool, optional): show amplitudes of the waveforms. Defaults to True.</span>

<span class="sd">            OUTPUTs:</span>
<span class="sd">                Any: plot figure.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">;</span>
        <span class="n">p_waveforms</span> <span class="o">=</span> <span class="p">{};</span>

        <span class="n">waveform_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">waveform_config</span><span class="p">;</span>
        <span class="n">coupling_color</span> <span class="o">=</span> <span class="n">waveform_config</span><span class="o">.</span><span class="n">DEFAULT_COLORS</span><span class="p">[</span><span class="s2">&quot;coupling&quot;</span><span class="p">];</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coupling_waveforms</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

            <span class="n">pair</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coupling_waveforms</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
            <span class="n">omega</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coupling_waveforms</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span>
            <span class="n">p_waveforms</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">omega</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[];</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coupling_waveforms</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

            <span class="n">pair</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coupling_waveforms</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
            <span class="n">waveform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coupling_waveforms</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
            <span class="n">omega</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coupling_waveforms</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span>
            <span class="n">p_waveforms</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">omega</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">waveform</span><span class="p">,</span> <span class="n">omega</span><span class="p">));</span>
    
        <span class="n">L</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_waveforms</span><span class="o">.</span><span class="n">keys</span><span class="p">());</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="p">));</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
            
            <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">p_waveforms</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">];</span>
        
            <span class="k">if</span> <span class="n">L</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">waveform</span><span class="p">,</span> <span class="n">omega</span> <span class="ow">in</span> <span class="n">p_waveforms</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">:</span>
                    
                    <span class="n">factor</span> <span class="o">=</span> <span class="n">omega</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">);</span>
                    <span class="n">max_amp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">waveform</span><span class="p">));</span>
                    
                    <span class="n">abs_waveform</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">waveform</span><span class="p">)</span><span class="o">/</span><span class="n">max_amp</span><span class="p">;</span>
                    <span class="n">angl_waveform</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">waveform</span><span class="p">);</span> <span class="c1">#phasor angle (from complex number)</span>

                    <span class="k">if</span> <span class="n">phase</span><span class="p">:</span>
                        <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">angl_waveform</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">aqipt</span><span class="o">.</span><span class="n">coupling_color</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">%</span> <span class="mi">4</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$\phi (t)$&quot;</span><span class="p">);</span>
                        <span class="n">axis</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">angl_waveform</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">aqipt</span><span class="o">.</span><span class="n">coupling_color</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">%</span> <span class="mi">4</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span>
                    <span class="k">if</span> <span class="n">amp</span><span class="p">:</span>
                        <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">abs_waveform</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">aqipt</span><span class="o">.</span><span class="n">coupling_color</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$\Omega (t)$&quot;</span><span class="p">);</span>
                        <span class="n">axis</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">abs_waveform</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">aqipt</span><span class="o">.</span><span class="n">coupling_color</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">);</span>

                    <span class="k">if</span> <span class="n">factor</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">axis</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.01</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;$\Omega = 2\pi</span><span class="si">{</span><span class="n">factor</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axis</span><span class="o">.</span><span class="n">transAxes</span><span class="p">);</span>

                <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">);</span>
               
                <span class="n">axis</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">for</span> <span class="n">waveform</span><span class="p">,</span> <span class="n">omega</span> <span class="ow">in</span> <span class="n">p_waveforms</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">:</span>
                    <span class="n">factor</span> <span class="o">=</span> <span class="n">omega</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">);</span>
                    <span class="n">max_amp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">waveform</span><span class="p">));</span>
                    
                    <span class="n">abs_waveform</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">waveform</span><span class="p">);</span>
                    <span class="n">angl_waveform</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">waveform</span><span class="p">);</span> <span class="c1">#phasor angle (from complex number)</span>
                    
                    <span class="k">if</span> <span class="n">phase</span><span class="p">:</span>
                        <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">angl_waveform</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">aqipt</span><span class="o">.</span><span class="n">coupling_color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$\phi (t)$&quot;</span><span class="p">);</span>
                        <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">angl_waveform</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">aqipt</span><span class="o">.</span><span class="n">coupling_color</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span>
                    <span class="k">if</span> <span class="n">amp</span><span class="p">:</span>
                        <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">abs_waveform</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">aqipt</span><span class="o">.</span><span class="n">coupling_color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$\Omega (t)$&quot;</span><span class="p">);</span>
                        <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">abs_waveform</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">aqipt</span><span class="o">.</span><span class="n">coupling_color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">);</span>

                    
                    <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.01</span><span class="p">,</span> <span class="mf">.99</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;$\Omega = 2\pi</span><span class="si">{</span><span class="n">factor</span><span class="si">:</span><span class="s1">0.2f</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">);</span>

                <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
                <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
               
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Coupling</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">key</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">plotON</span><span class="p">:</span> <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axis</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="RydbergQubitSchedule.plot_detunings">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.RydbergQubitSchedule.plot_detunings">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_detunings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Plot detuning function.</span>

<span class="sd">            INPUTS:</span>
<span class="sd">                plot (bool, optional): show plot. Defaults to True.</span>
<span class="sd">                name (str, optional): plots label. Defaults to &quot;&quot;.</span>
<span class="sd">                phase (bool, optional): show phases of waveforms. Defaults to True.</span>
<span class="sd">                amp (bool, optional): show amplitudes of the waveforms. Defaults to True.</span>

<span class="sd">            OUTPUTs:</span>
<span class="sd">                Any: plot figure.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">;</span>
        <span class="n">p_waveforms</span> <span class="o">=</span> <span class="p">{};</span>

        <span class="n">waveform_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">waveform_config</span><span class="p">;</span>
        <span class="n">detuning_color</span> <span class="o">=</span> <span class="n">waveform_config</span><span class="o">.</span><span class="n">DEFAULT_COLORS</span><span class="p">[</span><span class="s2">&quot;detuning&quot;</span><span class="p">];</span>

        <span class="n">simulation_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">simulation_config</span><span class="p">;</span>
        <span class="n">T_MAX</span> <span class="o">=</span> <span class="n">simulation_config</span><span class="o">.</span><span class="n">time_simulation</span><span class="p">;</span>

        <span class="k">for</span> <span class="n">waveform</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">detuning_waveforms</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">pair</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detuning_waveforms</span><span class="p">[</span><span class="n">waveform</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
            <span class="n">p_waveforms</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">pair</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[];</span>
        
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">detuning_waveforms</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">pair</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detuning_waveforms</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
            <span class="n">waveform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detuning_waveforms</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
            <span class="n">p_waveforms</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">pair</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">waveform</span><span class="p">);</span>

        <span class="n">L</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_waveforms</span><span class="o">.</span><span class="n">keys</span><span class="p">());</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="p">));</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p_waveforms</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            
            <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">p_waveforms</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">i</span><span class="p">];</span>
        
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_waveforms</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">waveform</span> <span class="ow">in</span> <span class="n">p_waveforms</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                    <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">waveform</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">detuning_color</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
                    <span class="n">axis</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">waveform</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">detuning_color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">);</span>
                    <span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">);</span>
                    <span class="n">axis</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T_MAX</span><span class="p">);</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="k">for</span> <span class="n">waveform</span> <span class="ow">in</span> <span class="n">p_waveforms</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                    <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">waveform</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">detuning_color</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
                    <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">waveform</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">detuning_color</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">);</span>
                    <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">);</span>
                    <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T_MAX</span><span class="p">);</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Detuning</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">key</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">plot</span><span class="p">:</span> <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axis</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="RydbergQubitSchedule.plot_all">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.RydbergQubitSchedule.plot_all">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">couplings_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">detunings_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Plot all function.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_couplings</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">couplings_label</span><span class="p">);</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_detunings</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">detunings_label</span><span class="p">);</span></div>
</div>



<span class="k">class</span> <span class="nc">RydbergQRegisterSchedule</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Class wrapper of the schedule for the Rydberg quantum register.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        schedules ():</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>

<span class="sd">        schedules (): </span>
<span class="sd">        times (): </span>
<span class="sd">        n_qubits (): </span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schedules</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">RydbergQubitSchedule</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="k">if</span> <span class="s2">&quot;backend&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">backend_config</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;backend&quot;</span><span class="p">];</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">backend_config</span><span class="p">,</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">BackendConfig</span><span class="p">);</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span> <span class="o">=</span> <span class="n">backend_config</span><span class="p">;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">backend_config</span><span class="p">;</span>

        <span class="n">simulation_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">simulation_config</span><span class="p">;</span>
        <span class="n">SAMPLING</span> <span class="o">=</span> <span class="n">simulation_config</span><span class="o">.</span><span class="n">sampling</span><span class="p">;</span>
        <span class="n">BITDEPTH</span> <span class="o">=</span> <span class="n">simulation_config</span><span class="o">.</span><span class="n">bitdepth</span><span class="p">;</span>
        <span class="n">T_MAX</span> <span class="o">=</span> <span class="n">simulation_config</span><span class="o">.</span><span class="n">time_simulation</span><span class="p">;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">schedules</span> <span class="o">=</span> <span class="n">schedules</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">general_params</span><span class="p">({</span><span class="s2">&quot;sampling&quot;</span><span class="p">:</span> <span class="n">SAMPLING</span><span class="p">,</span> <span class="s2">&quot;bitdepth&quot;</span><span class="p">:</span> <span class="n">BITDEPTH</span><span class="p">,</span> <span class="s2">&quot;time_dyn&quot;</span><span class="p">:</span> <span class="n">T_MAX</span><span class="p">})</span><span class="o">.</span><span class="n">timebase</span><span class="p">();</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_qubits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">schedules</span><span class="p">);</span>
        
    <span class="k">def</span> <span class="nf">plot_schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">couplings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">detunings</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Plot schedule of the quantum register.</span>

<span class="sd">            INPUTS</span>
<span class="sd">                couplings (bool, optional): visible plot for couplings. Defaults to True.</span>
<span class="sd">                detunings (bool, optional): visible plot for detunings. Defaults to False.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schedules</span><span class="p">)):</span>

            <span class="n">_schedule</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">schedules</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            
            <span class="k">if</span> <span class="n">couplings</span><span class="p">:</span>
                <span class="n">_schedule</span><span class="o">.</span><span class="n">plot_couplings</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
                
            <span class="k">if</span> <span class="n">detunings</span><span class="p">:</span>
                <span class="n">_schedule</span><span class="o">.</span><span class="n">plot_detunings</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39; </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>

<span class="c1">#####################################################################################################</span>
<span class="c1">#Rydberg quantum computing classes</span>
<span class="c1">#####################################################################################################</span>
<span class="kn">from</span> <span class="nn">AQiPT.modules.emulator</span> <span class="kn">import</span> <span class="n">AQiPTemulator</span> <span class="k">as</span> <span class="n">emulator</span>

<span class="n">WAVEFORM_PARAMS</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">simulation_config</span><span class="o">.</span><span class="n">WAVEFORM_PARAMS</span><span class="p">;</span>

<div class="viewcode-block" id="RydbergQubit">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.RydbergQubit">[docs]</a>
<span class="k">class</span> <span class="nc">RydbergQubit</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Class wrapper of the AQiPTemulator atomicModel for generating the atom instances for</span>
<span class="sd">        the simulation of transpiled quantum circuits.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        nr_levels (int): number of levels of the atomicModel instance (set to 2 for qubits)</span>
<span class="sd">        rydbergs_states (dict): dictionary for the states that are Rydberg states and the l </span>
<span class="sd">                                quantum number values corresponding to the list of states.</span>
<span class="sd">        dissipators ():</span>
<span class="sd">        initial_state ():</span>
<span class="sd">        name ():</span>
<span class="sd">        schedule ():</span>


<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>

<span class="sd">        nr_levels ():</span>
<span class="sd">        rydberg_states ():</span>
<span class="sd">        dissipators ():</span>
<span class="sd">        initial_state ():</span>
<span class="sd">        name ():</span>
<span class="sd">        schedule ():</span>
<span class="sd">        atom ():</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">nr_levels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
                 <span class="n">rydberg_states</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">atomic_config</span><span class="o">.</span><span class="n">rydberg_states</span><span class="p">,</span>
                 <span class="n">dissipators</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Dissipator0&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]},</span>
                 <span class="n">initial_state</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">qt</span><span class="o">.</span><span class="n">Qobj</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                 <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;qubit&quot;</span><span class="p">,</span>
                 <span class="n">schedule</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RydbergQubitSchedule</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">,):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nr_levels</span> <span class="o">=</span> <span class="n">nr_levels</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rydberg_states</span> <span class="o">=</span> <span class="n">rydberg_states</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dissipators</span> <span class="o">=</span> <span class="n">dissipators</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span> <span class="o">=</span> <span class="n">initial_state</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span> <span class="o">=</span> <span class="n">schedule</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>

        <span class="k">if</span> <span class="s2">&quot;backend&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">backend_config</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;backend&quot;</span><span class="p">];</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">backend_config</span><span class="p">,</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">BackendConfig</span><span class="p">);</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span> <span class="o">=</span> <span class="n">backend_config</span><span class="p">;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">backend_config</span><span class="p">;</span>

    <span class="k">def</span> <span class="nf">_compile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Compiler of the full atomicModel including the simulation of the instantiated class in the &#39;control&#39; mode.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">sim_params_q</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;couplings&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">coupling_waveforms</span><span class="p">,</span> 
                        <span class="s1">&#39;detunings&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">detuning_waveforms</span><span class="p">,</span> 
                        <span class="s1">&#39;dissipators&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">dissipators</span><span class="p">,</span>
                        <span class="s1">&#39;rydbergstates&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rydberg_states</span><span class="p">};</span> 

        <span class="n">simulation_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">simulation_config</span><span class="p">;</span>
        <span class="n">_qubit</span> <span class="o">=</span> <span class="n">emulator</span><span class="o">.</span><span class="n">atomicModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> 
                                      <span class="bp">self</span><span class="o">.</span><span class="n">nr_levels</span><span class="p">,</span> 
                                      <span class="bp">self</span><span class="o">.</span><span class="n">initial_state</span><span class="p">,</span> 
                                      <span class="n">sim_params_q</span><span class="p">,</span> 
                                      <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> 
                                      <span class="n">simOpt</span><span class="o">=</span><span class="n">qt</span><span class="o">.</span><span class="n">Options</span><span class="p">(</span><span class="n">nsteps</span><span class="o">=</span><span class="n">simulation_config</span><span class="o">.</span><span class="n">nsteps</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">simulation_config</span><span class="o">.</span><span class="n">rtol</span><span class="p">,</span> <span class="n">max_step</span><span class="o">=</span><span class="n">simulation_config</span><span class="o">.</span><span class="n">max_steps</span><span class="p">,</span> <span class="n">store_states</span><span class="o">=</span><span class="n">simulation_config</span><span class="o">.</span><span class="n">store_states</span><span class="p">));</span>
        <span class="n">_qubit</span><span class="o">.</span><span class="n">modelMap</span><span class="p">(</span><span class="n">plotON</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>

        <span class="n">_qubit</span><span class="o">.</span><span class="n">buildTHamiltonian</span><span class="p">();</span>
        <span class="c1"># _qubit.buildHamiltonian();</span>
        <span class="c1"># _qubit.buildLindbladians();</span>
        
        <span class="n">_qubit</span><span class="o">.</span><span class="n">buildObservables</span><span class="p">();</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span> <span class="o">=</span> <span class="n">_qubit</span><span class="p">;</span>

<div class="viewcode-block" id="RydbergQubit.simulate">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.RydbergQubit.simulate">[docs]</a>
    <span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">playSim</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;control&#39;</span><span class="p">);</span></div>


    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{self.name}</span><span class="s1">&#39;</span><span class="p">)</span>
    
<div class="viewcode-block" id="RydbergQubit.plot_results">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.RydbergQubit.plot_results">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Plotting results of simulation.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">waveform_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">waveform_config</span><span class="p">;</span>
        <span class="n">other_color</span> <span class="o">=</span> <span class="n">waveform_config</span><span class="o">.</span><span class="n">DEFAULT_COLORS</span><span class="p">[</span><span class="s2">&quot;other&quot;</span><span class="p">];</span>
        <span class="n">simRes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">getResult</span><span class="p">();</span>
        
        <span class="n">states</span> <span class="o">=</span> <span class="n">simRes</span><span class="o">.</span><span class="n">expect</span><span class="p">;</span>
        <span class="n">sl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">);</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">sl</span><span class="p">));</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sl</span><span class="p">):</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">states</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            
            <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">other_color</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">]);</span>
            <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;State </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
            <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;silver&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">);</span>
            <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">);</span>
            <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">);</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">sl</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">);</span>
                
            <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Population evolution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">);</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">supxlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">);</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
</div>


<div class="viewcode-block" id="RydbergQuantumRegister">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.RydbergQuantumRegister">[docs]</a>
<span class="k">class</span> <span class="nc">RydbergQuantumRegister</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Class wrapper of the AQiPTemulator atomicQRegister for generating the quantum register</span>
<span class="sd">        instances for the simulation of transpiled quantum circuits.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        nr_levels (int): number of levels of the atomicModel instance (set to 2 for qubits)</span>
<span class="sd">        rydbergs_states (dict): dictionary for the states that are Rydberg states and the l </span>
<span class="sd">                                quantum number values corresponding to the list of states.</span>
<span class="sd">        qubits ():</span>
<span class="sd">        layout ():</span>
<span class="sd">        init_state ():</span>
<span class="sd">        name ():</span>
<span class="sd">        connectivity ():</span>
<span class="sd">        c6 ():</span>
<span class="sd">        c3 ():</span>
<span class="sd">        times ():</span>


<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>

<span class="sd">        qubits ():</span>
<span class="sd">        layout ():</span>
<span class="sd">        init_state ():</span>
<span class="sd">        name ():</span>
<span class="sd">        connectivity ():</span>
<span class="sd">        c6 ():</span>
<span class="sd">        c3 ():</span>
<span class="sd">        times ():</span>
<span class="sd">        atomic_qregister ():</span>
<span class="sd">        schedule ():</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">qubits</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">RydbergQubit</span><span class="p">],</span>
                 <span class="n">layout</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">atomic_config</span><span class="o">.</span><span class="n">layout</span><span class="p">,</span>
                 <span class="n">init_state</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">qt</span><span class="o">.</span><span class="n">Qobj</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Quantum Register&quot;</span><span class="p">,</span>
                 <span class="n">connectivity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">atomic_config</span><span class="o">.</span><span class="n">connectivity</span><span class="p">,</span>
                 <span class="n">c6</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">atomic_config</span><span class="o">.</span><span class="n">c6_constant</span><span class="p">,</span>
                 <span class="n">c3</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">atomic_config</span><span class="o">.</span><span class="n">c3_constant</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">,):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span> <span class="o">=</span> <span class="n">qubits</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">layout</span><span class="p">;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">init_state</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_state</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">qubits</span><span class="p">))</span> <span class="k">if</span> <span class="n">init_state</span> <span class="o">==</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">init_state</span><span class="p">);</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_state</span> <span class="o">=</span> <span class="n">init_state</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span> <span class="o">=</span> <span class="n">connectivity</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c6</span> <span class="o">=</span> <span class="n">c6</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c3</span> <span class="o">=</span> <span class="n">c3</span><span class="p">;</span>

        <span class="k">if</span> <span class="s2">&quot;backend&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

            <span class="n">backend_config</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;backend&quot;</span><span class="p">]</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">backend_config</span><span class="p">,</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">BackendConfig</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span> <span class="o">=</span> <span class="n">backend_config</span><span class="p">;</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">backend_config</span><span class="p">;</span>

        <span class="n">simulation_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">simulation_config</span><span class="p">;</span>
        <span class="n">SAMPLING</span> <span class="o">=</span> <span class="n">simulation_config</span><span class="o">.</span><span class="n">sampling</span><span class="p">;</span>
        <span class="n">BITDEPTH</span> <span class="o">=</span> <span class="n">simulation_config</span><span class="o">.</span><span class="n">bitdepth</span><span class="p">;</span>
        <span class="n">T_MAX</span> <span class="o">=</span> <span class="n">simulation_config</span><span class="o">.</span><span class="n">time_simulation</span><span class="p">;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">=</span> <span class="n">aqipt</span><span class="o">.</span><span class="n">general_params</span><span class="p">({</span><span class="s2">&quot;sampling&quot;</span><span class="p">:</span> <span class="n">SAMPLING</span><span class="p">,</span> <span class="s2">&quot;bitdepth&quot;</span><span class="p">:</span> <span class="n">BITDEPTH</span><span class="p">,</span> <span class="s2">&quot;time_dyn&quot;</span><span class="p">:</span> <span class="n">T_MAX</span><span class="p">})</span><span class="o">.</span><span class="n">timebase</span><span class="p">();</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">atomic_qregister</span> <span class="o">=</span> <span class="kc">None</span><span class="p">;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="k">def</span> <span class="nf">_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Instantiate a set of atomicModels for being the qubits to be simulated for the quantum</span>
<span class="sd">            circuit transpilation.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">atoms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">qubit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">qubit</span><span class="o">.</span><span class="n">atom</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">qubit</span><span class="o">.</span><span class="n">_compile</span><span class="p">();</span>
                <span class="n">qubit</span><span class="o">.</span><span class="n">simulate</span><span class="p">();</span>
            <span class="n">atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qubit</span><span class="o">.</span><span class="n">atom</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">atoms</span>

<div class="viewcode-block" id="RydbergQuantumRegister.compile">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.RydbergQuantumRegister.compile">[docs]</a>
    <span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Setting of the full atomicQRegister of the instantiated class.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">atomic_qregister</span> <span class="o">=</span> <span class="n">emulator</span><span class="o">.</span><span class="n">atomicQRegister</span><span class="p">(</span><span class="n">physicalRegisters</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atoms</span><span class="p">(),</span>
                                                    <span class="n">initnState</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_state</span><span class="p">,</span>
                                                    <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                                    <span class="n">connectivity</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connectivity</span><span class="p">,</span>
                                                    <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">);</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_schedule</span><span class="p">();</span>
        <span class="n">atomic_qregister</span><span class="o">.</span><span class="n">buildNinitState</span><span class="p">();</span>
        <span class="n">atomic_qregister</span><span class="o">.</span><span class="n">buildTNHamiltonian</span><span class="p">();</span> 
        <span class="n">atomic_qregister</span><span class="o">.</span><span class="n">registerMap</span><span class="p">(</span><span class="n">plotON</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">figure_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">));</span> 

        <span class="n">simulation_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">simulation_config</span>
        <span class="n">atomic_qregister</span><span class="o">.</span><span class="n">simOpts</span> <span class="o">=</span> <span class="n">qt</span><span class="o">.</span><span class="n">Options</span><span class="p">(</span><span class="n">nsteps</span><span class="o">=</span><span class="n">simulation_config</span><span class="o">.</span><span class="n">nsteps</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">simulation_config</span><span class="o">.</span><span class="n">rtol</span><span class="p">,</span> <span class="n">max_step</span><span class="o">=</span><span class="n">simulation_config</span><span class="o">.</span><span class="n">max_steps</span><span class="p">,</span> <span class="n">store_states</span><span class="o">=</span><span class="n">simulation_config</span><span class="o">.</span><span class="n">store_states</span><span class="p">);</span>
        
        <span class="n">atomic_qregister</span><span class="o">.</span><span class="n">compile</span><span class="p">();</span>
        <span class="n">atomic_qregister</span><span class="o">.</span><span class="n">buildInteractions</span><span class="p">(</span><span class="n">c6</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c6</span><span class="p">,</span> <span class="n">c3</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">c3</span><span class="p">);</span> 
        <span class="c1"># atomic_qregister.buildNLindbladians();</span>
        
        <span class="n">atomic_qregister</span><span class="o">.</span><span class="n">buildNObservables</span><span class="p">();</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">atomic_qregister</span> <span class="o">=</span> <span class="n">atomic_qregister</span><span class="p">;</span></div>


<div class="viewcode-block" id="RydbergQuantumRegister.simulate">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.RydbergQuantumRegister.simulate">[docs]</a>
    <span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Compile of the full atomicQRegister including the simulation of the instantiated class in the &#39;control&#39; mode.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atomic_qregister</span><span class="o">.</span><span class="n">playSim</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;control&#39;</span><span class="p">);</span></div>


    <span class="k">def</span> <span class="nf">_schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Yields the schedule of the Rydberg quantum register.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">qubits_schedules_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">qubit</span><span class="o">.</span><span class="n">schedule</span> <span class="k">for</span> <span class="n">qubit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">];</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span> <span class="o">=</span> <span class="n">RydbergQRegisterSchedule</span><span class="p">(</span><span class="n">qubits_schedules_lst</span><span class="p">);</span>

<div class="viewcode-block" id="RydbergQuantumRegister.plot_schedule">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.RydbergQuantumRegister.plot_schedule">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">couplings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">detunings</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Plot schedule of the Rydberg quantum register e.g., couplings and detunings.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">waveform_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">waveform_config</span><span class="p">;</span>
        <span class="n">coupling_color</span> <span class="o">=</span> <span class="n">waveform_config</span><span class="o">.</span><span class="n">DEFAULT_COLORS</span><span class="p">[</span><span class="s2">&quot;coupling&quot;</span><span class="p">]</span>
        <span class="n">detuning_color</span> <span class="o">=</span> <span class="n">waveform_config</span><span class="o">.</span><span class="n">DEFAULT_COLORS</span><span class="p">[</span><span class="s2">&quot;detuning&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">schedule</span><span class="o">.</span><span class="n">plot_schedule</span><span class="p">(</span><span class="n">couplings</span><span class="p">,</span> <span class="n">detunings</span><span class="p">,</span> <span class="n">coupling_color</span><span class="p">,</span> <span class="n">detuning_color</span><span class="p">);</span></div>


<div class="viewcode-block" id="RydbergQuantumRegister.plot_results">
<a class="viewcode-back" href="../../../source/modules.html#modules.kernel.AQiPTkernel.RydbergQuantumRegister.plot_results">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">           Plot results from the simulation of the Rydberg Quantum Register associated to the transpiled quantum circuit.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">waveform_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_config</span><span class="o">.</span><span class="n">waveform_config</span><span class="p">;</span>
        <span class="n">other_color</span> <span class="o">=</span> <span class="n">waveform_config</span><span class="o">.</span><span class="n">DEFAULT_COLORS</span><span class="p">[</span><span class="s2">&quot;other&quot;</span><span class="p">];</span>

        <span class="n">simRes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atomic_qregister</span><span class="o">.</span><span class="n">getResult</span><span class="p">();</span>
        
        <span class="n">states</span> <span class="o">=</span> <span class="n">simRes</span><span class="o">.</span><span class="n">expect</span><span class="p">;</span>
        <span class="n">sl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">);</span>

        <span class="n">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rydberg_states</span><span class="p">[</span><span class="s1">&#39;l_values&#39;</span><span class="p">];</span>
        <span class="n">perm_lev</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">levels</span><span class="p">,</span> <span class="n">repeat</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qubits</span><span class="p">)));</span>


        <span class="n">fig</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mf">1.7</span><span class="o">*</span><span class="n">sl</span><span class="p">));</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sl</span><span class="p">):</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">states</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            
            <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">other_color</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">4</span><span class="p">]);</span>
            <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;State </span><span class="si">{</span><span class="n">perm_lev</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
            <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
            <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;silver&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">);</span>
            <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">);</span>
            <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">);</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">sl</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">axis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">);</span>
                
            <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Population evolution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">);</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">supxlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">);</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, AQiPT developers and contributors. Last updated on Oct 27, 2022. .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XXXXXXXXXX', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>